LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name  | Type     | Params | Mode
-------------------------------------------
0 | model | Wang2024 | 2.4 M  | train
-------------------------------------------
2.4 M     Trainable params
0         Non-trainable params
2.4 M     Total params
9.480     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
Sanity Checking DataLoader 0:   0%|                                                                       | 0/2 [00:00<?, ?it/s][0;31m---------------------------------------------------------------------------[0m
[0;31mRuntimeError[0m                              Traceback (most recent call last)
File [0;32m/shared_netapp3_home/home/rogui7909/code/predict_rain_norway/rain_lighting.py:141[0m
[1;32m    135[0m model [38;5;241m=[39m LitCNN(CNN)
[1;32m    140[0m [38;5;28mprint[39m([38;5;124m'[39m[38;5;124mModel init[39m[38;5;124m'[39m)
[0;32m--> 141[0m [43mtrainer[49m[38;5;241;43m.[39;49m[43mfit[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[43mtrain_loader[49m[43m,[49m[43m [49m[43mvalid_loader[49m[43m)[49m
[1;32m    144[0m model[38;5;241m.[39meval()
[1;32m    145[0m trainer[38;5;241m.[39mtest(model, dataloaders[38;5;241m=[39mtest_loader)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:539[0m, in [0;36mTrainer.fit[0;34m(self, model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)[0m
[1;32m    537[0m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstatus [38;5;241m=[39m TrainerStatus[38;5;241m.[39mRUNNING
[1;32m    538[0m [38;5;28mself[39m[38;5;241m.[39mtraining [38;5;241m=[39m [38;5;28;01mTrue[39;00m
[0;32m--> 539[0m [43mcall[49m[38;5;241;43m.[39;49m[43m_call_and_handle_interrupt[49m[43m([49m
[1;32m    540[0m [43m    [49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_fit_impl[49m[43m,[49m[43m [49m[43mmodel[49m[43m,[49m[43m [49m[43mtrain_dataloaders[49m[43m,[49m[43m [49m[43mval_dataloaders[49m[43m,[49m[43m [49m[43mdatamodule[49m[43m,[49m[43m [49m[43mckpt_path[49m
[1;32m    541[0m [43m[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/call.py:47[0m, in [0;36m_call_and_handle_interrupt[0;34m(trainer, trainer_fn, *args, **kwargs)[0m
[1;32m     45[0m     [38;5;28;01mif[39;00m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mlauncher [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m     46[0m         [38;5;28;01mreturn[39;00m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mlauncher[38;5;241m.[39mlaunch(trainer_fn, [38;5;241m*[39margs, trainer[38;5;241m=[39mtrainer, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[0;32m---> 47[0m     [38;5;28;01mreturn[39;00m [43mtrainer_fn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     49[0m [38;5;28;01mexcept[39;00m _TunerExitException:
[1;32m     50[0m     _call_teardown_hook(trainer)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:575[0m, in [0;36mTrainer._fit_impl[0;34m(self, model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)[0m
[1;32m    568[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfn [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[1;32m    569[0m ckpt_path [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_checkpoint_connector[38;5;241m.[39m_select_ckpt_path(
[1;32m    570[0m     [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfn,
[1;32m    571[0m     ckpt_path,
[1;32m    572[0m     model_provided[38;5;241m=[39m[38;5;28;01mTrue[39;00m,
[1;32m    573[0m     model_connected[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mlightning_module [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m,
[1;32m    574[0m )
[0;32m--> 575[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[43mckpt_path[49m[38;5;241;43m=[39;49m[43mckpt_path[49m[43m)[49m
[1;32m    577[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstopped
[1;32m    578[0m [38;5;28mself[39m[38;5;241m.[39mtraining [38;5;241m=[39m [38;5;28;01mFalse[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:982[0m, in [0;36mTrainer._run[0;34m(self, model, ckpt_path)[0m
[1;32m    977[0m [38;5;28mself[39m[38;5;241m.[39m_signal_connector[38;5;241m.[39mregister_signal_handlers()
[1;32m    979[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    980[0m [38;5;66;03m# RUN THE TRAINER[39;00m
[1;32m    981[0m [38;5;66;03m# ----------------------------[39;00m
[0;32m--> 982[0m results [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run_stage[49m[43m([49m[43m)[49m
[1;32m    984[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    985[0m [38;5;66;03m# POST-Training CLEAN UP[39;00m
[1;32m    986[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    987[0m log[38;5;241m.[39mdebug([38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m: trainer tearing down[39m[38;5;124m"[39m)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:1024[0m, in [0;36mTrainer._run_stage[0;34m(self)[0m
[1;32m   1022[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mtraining:
[1;32m   1023[0m     [38;5;28;01mwith[39;00m isolate_rng():
[0;32m-> 1024[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run_sanity_check[49m[43m([49m[43m)[49m
[1;32m   1025[0m     [38;5;28;01mwith[39;00m torch[38;5;241m.[39mautograd[38;5;241m.[39mset_detect_anomaly([38;5;28mself[39m[38;5;241m.[39m_detect_anomaly):
[1;32m   1026[0m         [38;5;28mself[39m[38;5;241m.[39mfit_loop[38;5;241m.[39mrun()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:1053[0m, in [0;36mTrainer._run_sanity_check[0;34m(self)[0m
[1;32m   1050[0m call[38;5;241m.[39m_call_callback_hooks([38;5;28mself[39m, [38;5;124m"[39m[38;5;124mon_sanity_check_start[39m[38;5;124m"[39m)
[1;32m   1052[0m [38;5;66;03m# run eval step[39;00m
[0;32m-> 1053[0m [43mval_loop[49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[43m)[49m
[1;32m   1055[0m call[38;5;241m.[39m_call_callback_hooks([38;5;28mself[39m, [38;5;124m"[39m[38;5;124mon_sanity_check_end[39m[38;5;124m"[39m)
[1;32m   1057[0m [38;5;66;03m# reset logger connector[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/utilities.py:179[0m, in [0;36m_no_grad_context.<locals>._decorator[0;34m(self, *args, **kwargs)[0m
[1;32m    177[0m     context_manager [38;5;241m=[39m torch[38;5;241m.[39mno_grad
[1;32m    178[0m [38;5;28;01mwith[39;00m context_manager():
[0;32m--> 179[0m     [38;5;28;01mreturn[39;00m [43mloop_run[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/evaluation_loop.py:144[0m, in [0;36m_EvaluationLoop.run[0;34m(self)[0m
[1;32m    142[0m     [38;5;28mself[39m[38;5;241m.[39mbatch_progress[38;5;241m.[39mis_last_batch [38;5;241m=[39m data_fetcher[38;5;241m.[39mdone
[1;32m    143[0m     [38;5;66;03m# run step hooks[39;00m
[0;32m--> 144[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_evaluation_step[49m[43m([49m[43mbatch[49m[43m,[49m[43m [49m[43mbatch_idx[49m[43m,[49m[43m [49m[43mdataloader_idx[49m[43m,[49m[43m [49m[43mdataloader_iter[49m[43m)[49m
[1;32m    145[0m [38;5;28;01mexcept[39;00m [38;5;167;01mStopIteration[39;00m:
[1;32m    146[0m     [38;5;66;03m# this needs to wrap the `*_step` call too (not just `next`) for `dataloader_iter` support[39;00m
[1;32m    147[0m     [38;5;28;01mbreak[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/evaluation_loop.py:433[0m, in [0;36m_EvaluationLoop._evaluation_step[0;34m(self, batch, batch_idx, dataloader_idx, dataloader_iter)[0m
[1;32m    427[0m hook_name [38;5;241m=[39m [38;5;124m"[39m[38;5;124mtest_step[39m[38;5;124m"[39m [38;5;28;01mif[39;00m trainer[38;5;241m.[39mtesting [38;5;28;01melse[39;00m [38;5;124m"[39m[38;5;124mvalidation_step[39m[38;5;124m"[39m
[1;32m    428[0m step_args [38;5;241m=[39m (
[1;32m    429[0m     [38;5;28mself[39m[38;5;241m.[39m_build_step_args_from_hook_kwargs(hook_kwargs, hook_name)
[1;32m    430[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m using_dataloader_iter
[1;32m    431[0m     [38;5;28;01melse[39;00m (dataloader_iter,)
[1;32m    432[0m )
[0;32m--> 433[0m output [38;5;241m=[39m [43mcall[49m[38;5;241;43m.[39;49m[43m_call_strategy_hook[49m[43m([49m[43mtrainer[49m[43m,[49m[43m [49m[43mhook_name[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43mstep_args[49m[43m)[49m
[1;32m    435[0m [38;5;28mself[39m[38;5;241m.[39mbatch_progress[38;5;241m.[39mincrement_processed()
[1;32m    437[0m [38;5;28;01mif[39;00m using_dataloader_iter:
[1;32m    438[0m     [38;5;66;03m# update the hook kwargs now that the step method might have consumed the iterator[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/call.py:323[0m, in [0;36m_call_strategy_hook[0;34m(trainer, hook_name, *args, **kwargs)[0m
[1;32m    320[0m     [38;5;28;01mreturn[39;00m [38;5;28;01mNone[39;00m
[1;32m    322[0m [38;5;28;01mwith[39;00m trainer[38;5;241m.[39mprofiler[38;5;241m.[39mprofile([38;5;124mf[39m[38;5;124m"[39m[38;5;124m[Strategy][39m[38;5;132;01m{[39;00mtrainer[38;5;241m.[39mstrategy[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m.[39m[38;5;132;01m{[39;00mhook_name[38;5;132;01m}[39;00m[38;5;124m"[39m):
[0;32m--> 323[0m     output [38;5;241m=[39m [43mfn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    325[0m [38;5;66;03m# restore current_fx when nested context[39;00m
[1;32m    326[0m pl_module[38;5;241m.[39m_current_fx_name [38;5;241m=[39m prev_fx_name

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/strategies/strategy.py:412[0m, in [0;36mStrategy.validation_step[0;34m(self, *args, **kwargs)[0m
[1;32m    410[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mmodel [38;5;241m!=[39m [38;5;28mself[39m[38;5;241m.[39mlightning_module:
[1;32m    411[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_redirection([38;5;28mself[39m[38;5;241m.[39mmodel, [38;5;28mself[39m[38;5;241m.[39mlightning_module, [38;5;124m"[39m[38;5;124mvalidation_step[39m[38;5;124m"[39m, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[0;32m--> 412[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mlightning_module[49m[38;5;241;43m.[39;49m[43mvalidation_step[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/shared_netapp3_home/home/rogui7909/code/predict_rain_norway/rain_lighting.py:64[0m, in [0;36mLitCNN.validation_step[0;34m(self, batch, batch_idx)[0m
[1;32m     62[0m x, y [38;5;241m=[39m batch
[1;32m     63[0m [38;5;66;03m# x = x.view(x.size(0), -1)[39;00m
[0;32m---> 64[0m pred [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mmodel[49m[43m([49m[43mx[49m[43m)[49m
[1;32m     65[0m loss [38;5;241m=[39m nn[38;5;241m.[39mCrossEntropyLoss()(pred, y)
[1;32m     66[0m [38;5;28mself[39m[38;5;241m.[39mlog([38;5;124m"[39m[38;5;124mval/loss[39m[38;5;124m"[39m, loss)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1736[0m, in [0;36mModule._wrapped_call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1734[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_compiled_call_impl([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)  [38;5;66;03m# type: ignore[misc][39;00m
[1;32m   1735[0m [38;5;28;01melse[39;00m:
[0;32m-> 1736[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_call_impl[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1747[0m, in [0;36mModule._call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1742[0m [38;5;66;03m# If we don't have any hooks, we want to skip the rest of the logic in[39;00m
[1;32m   1743[0m [38;5;66;03m# this function, and just call forward.[39;00m
[1;32m   1744[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m ([38;5;28mself[39m[38;5;241m.[39m_backward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_backward_pre_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_pre_hooks
[1;32m   1745[0m         [38;5;129;01mor[39;00m _global_backward_pre_hooks [38;5;129;01mor[39;00m _global_backward_hooks
[1;32m   1746[0m         [38;5;129;01mor[39;00m _global_forward_hooks [38;5;129;01mor[39;00m _global_forward_pre_hooks):
[0;32m-> 1747[0m     [38;5;28;01mreturn[39;00m [43mforward_call[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m   1749[0m result [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m   1750[0m called_always_called_hooks [38;5;241m=[39m [38;5;28mset[39m()

File [0;32m/shared_netapp3_home/home/rogui7909/code/predict_rain_norway/models/model.py:51[0m, in [0;36mWang2024.forward[0;34m(self, x)[0m
[1;32m     50[0m [38;5;28;01mdef[39;00m [38;5;21mforward[39m([38;5;28mself[39m, x):
[0;32m---> 51[0m     x [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mconv1[49m[43m([49m[43mx[49m[43m)[49m
[1;32m     52[0m     x [38;5;241m=[39m nn[38;5;241m.[39mReLU()(x)
[1;32m     53[0m     x [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mpool1(x)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1736[0m, in [0;36mModule._wrapped_call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1734[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_compiled_call_impl([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)  [38;5;66;03m# type: ignore[misc][39;00m
[1;32m   1735[0m [38;5;28;01melse[39;00m:
[0;32m-> 1736[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_call_impl[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1747[0m, in [0;36mModule._call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1742[0m [38;5;66;03m# If we don't have any hooks, we want to skip the rest of the logic in[39;00m
[1;32m   1743[0m [38;5;66;03m# this function, and just call forward.[39;00m
[1;32m   1744[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m ([38;5;28mself[39m[38;5;241m.[39m_backward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_backward_pre_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_pre_hooks
[1;32m   1745[0m         [38;5;129;01mor[39;00m _global_backward_pre_hooks [38;5;129;01mor[39;00m _global_backward_hooks
[1;32m   1746[0m         [38;5;129;01mor[39;00m _global_forward_hooks [38;5;129;01mor[39;00m _global_forward_pre_hooks):
[0;32m-> 1747[0m     [38;5;28;01mreturn[39;00m [43mforward_call[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m   1749[0m result [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m   1750[0m called_always_called_hooks [38;5;241m=[39m [38;5;28mset[39m()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/conv.py:554[0m, in [0;36mConv2d.forward[0;34m(self, input)[0m
[1;32m    553[0m [38;5;28;01mdef[39;00m [38;5;21mforward[39m([38;5;28mself[39m, [38;5;28minput[39m: Tensor) [38;5;241m-[39m[38;5;241m>[39m Tensor:
[0;32m--> 554[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_conv_forward[49m[43m([49m[38;5;28;43minput[39;49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mweight[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mbias[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/conv.py:549[0m, in [0;36mConv2d._conv_forward[0;34m(self, input, weight, bias)[0m
[1;32m    537[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mpadding_mode [38;5;241m!=[39m [38;5;124m"[39m[38;5;124mzeros[39m[38;5;124m"[39m:
[1;32m    538[0m     [38;5;28;01mreturn[39;00m F[38;5;241m.[39mconv2d(
[1;32m    539[0m         F[38;5;241m.[39mpad(
[1;32m    540[0m             [38;5;28minput[39m, [38;5;28mself[39m[38;5;241m.[39m_reversed_padding_repeated_twice, mode[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mpadding_mode
[0;32m   (...)[0m
[1;32m    547[0m         [38;5;28mself[39m[38;5;241m.[39mgroups,
[1;32m    548[0m     )
[0;32m--> 549[0m [38;5;28;01mreturn[39;00m [43mF[49m[38;5;241;43m.[39;49m[43mconv2d[49m[43m([49m
[1;32m    550[0m [43m    [49m[38;5;28;43minput[39;49m[43m,[49m[43m [49m[43mweight[49m[43m,[49m[43m [49m[43mbias[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mstride[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mpadding[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdilation[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mgroups[49m
[1;32m    551[0m [43m[49m[43m)[49m

[0;31mRuntimeError[0m: Expected 3D (unbatched) or 4D (batched) input to conv2d, but got input of size: [128, 8192]



Model init
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name  | Type     | Params | Mode
-------------------------------------------
0 | model | Wang2024 | 2.4 M  | train
-------------------------------------------
2.4 M     Trainable params
0         Non-trainable params
2.4 M     Total params
9.480     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
Epoch 9: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 79/79 [00:27<00:00,  2.89it/s, v_num=6hqa]
                                                                                                                                
`Trainer.fit` stopped: `max_epochs=10` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
Testing DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 25/25 [00:00<00:00, 122.97it/s]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       Test metric             DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        test/loss           1.9005482196807861
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[{'test/loss': 1.9005482196807861}]

[0;31m---------------------------------------------------------------------------[0m
[0;31mMisconfigurationException[0m                 Traceback (most recent call last)
Cell [0;32mIn[6], line 4[0m
[1;32m      1[0m model[38;5;241m.[39meval()
[1;32m      2[0m [38;5;28;01mwith[39;00m torch[38;5;241m.[39mno_grad():
[1;32m      3[0m     [38;5;66;03m# trainer.test(model, dataloaders=test_loader)[39;00m
[0;32m----> 4[0m     predictions_test [38;5;241m=[39m [43mtrainer[49m[38;5;241;43m.[39;49m[43mpredict[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[43mtest_loader[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:859[0m, in [0;36mTrainer.predict[0;34m(self, model, dataloaders, datamodule, return_predictions, ckpt_path)[0m
[1;32m    857[0m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstatus [38;5;241m=[39m TrainerStatus[38;5;241m.[39mRUNNING
[1;32m    858[0m [38;5;28mself[39m[38;5;241m.[39mpredicting [38;5;241m=[39m [38;5;28;01mTrue[39;00m
[0;32m--> 859[0m [38;5;28;01mreturn[39;00m [43mcall[49m[38;5;241;43m.[39;49m[43m_call_and_handle_interrupt[49m[43m([49m
[1;32m    860[0m [43m    [49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_predict_impl[49m[43m,[49m[43m [49m[43mmodel[49m[43m,[49m[43m [49m[43mdataloaders[49m[43m,[49m[43m [49m[43mdatamodule[49m[43m,[49m[43m [49m[43mreturn_predictions[49m[43m,[49m[43m [49m[43mckpt_path[49m
[1;32m    861[0m [43m[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/call.py:47[0m, in [0;36m_call_and_handle_interrupt[0;34m(trainer, trainer_fn, *args, **kwargs)[0m
[1;32m     45[0m     [38;5;28;01mif[39;00m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mlauncher [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m     46[0m         [38;5;28;01mreturn[39;00m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mlauncher[38;5;241m.[39mlaunch(trainer_fn, [38;5;241m*[39margs, trainer[38;5;241m=[39mtrainer, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[0;32m---> 47[0m     [38;5;28;01mreturn[39;00m [43mtrainer_fn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     49[0m [38;5;28;01mexcept[39;00m _TunerExitException:
[1;32m     50[0m     _call_teardown_hook(trainer)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:898[0m, in [0;36mTrainer._predict_impl[0;34m(self, model, dataloaders, datamodule, return_predictions, ckpt_path)[0m
[1;32m    894[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfn [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[1;32m    895[0m ckpt_path [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_checkpoint_connector[38;5;241m.[39m_select_ckpt_path(
[1;32m    896[0m     [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfn, ckpt_path, model_provided[38;5;241m=[39mmodel_provided, model_connected[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mlightning_module [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[1;32m    897[0m )
[0;32m--> 898[0m results [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[43mckpt_path[49m[38;5;241;43m=[39;49m[43mckpt_path[49m[43m)[49m
[1;32m    900[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstopped
[1;32m    901[0m [38;5;28mself[39m[38;5;241m.[39mpredicting [38;5;241m=[39m [38;5;28;01mFalse[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:932[0m, in [0;36mTrainer._run[0;34m(self, model, ckpt_path)[0m
[1;32m    929[0m [38;5;28mself[39m[38;5;241m.[39m_callback_connector[38;5;241m.[39m_attach_model_callbacks()
[1;32m    930[0m [38;5;28mself[39m[38;5;241m.[39m_callback_connector[38;5;241m.[39m_attach_model_logging_functions()
[0;32m--> 932[0m [43m_verify_loop_configurations[49m[43m([49m[38;5;28;43mself[39;49m[43m)[49m
[1;32m    934[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    935[0m [38;5;66;03m# SET UP THE TRAINER[39;00m
[1;32m    936[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    937[0m log[38;5;241m.[39mdebug([38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m: setting up strategy environment[39m[38;5;124m"[39m)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/configuration_validator.py:43[0m, in [0;36m_verify_loop_configurations[0;34m(trainer)[0m
[1;32m     41[0m     __verify_eval_loop_configuration(model, [38;5;124m"[39m[38;5;124mtest[39m[38;5;124m"[39m)
[1;32m     42[0m [38;5;28;01melif[39;00m trainer[38;5;241m.[39mstate[38;5;241m.[39mfn [38;5;241m==[39m TrainerFn[38;5;241m.[39mPREDICTING:
[0;32m---> 43[0m     [43m__verify_eval_loop_configuration[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mpredict[39;49m[38;5;124;43m"[39;49m[43m)[49m
[1;32m     45[0m __verify_configure_model_configuration(model)
[1;32m     46[0m __warn_dataloader_iter_limitations(model)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/configuration_validator.py:101[0m, in [0;36m__verify_eval_loop_configuration[0;34m(model, stage)[0m
[1;32m     99[0m         [38;5;28;01mraise[39;00m MisconfigurationException([38;5;124m"[39m[38;5;124m`predict_step` cannot be None to run `Trainer.predict`[39m[38;5;124m"[39m)
[1;32m    100[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m has_step [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m is_overridden([38;5;124m"[39m[38;5;124mforward[39m[38;5;124m"[39m, model):
[0;32m--> 101[0m         [38;5;28;01mraise[39;00m MisconfigurationException([38;5;124m"[39m[38;5;124m`Trainer.predict` requires `forward` method to run.[39m[38;5;124m"[39m)
[1;32m    102[0m [38;5;28;01melse[39;00m:
[1;32m    103[0m     [38;5;66;03m# verify minimum evaluation requirements[39;00m
[1;32m    104[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m has_step:

[0;31mMisconfigurationException[0m: `Trainer.predict` requires `forward` method to run.

[0;31m---------------------------------------------------------------------------[0m
[0;31mAttributeError[0m                            Traceback (most recent call last)
Cell [0;32mIn[7], line 1[0m
[0;32m----> 1[0m [43mmodel[49m[38;5;241;43m.[39;49m[43mCNN[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1931[0m, in [0;36mModule.__getattr__[0;34m(self, name)[0m
[1;32m   1929[0m     [38;5;28;01mif[39;00m name [38;5;129;01min[39;00m modules:
[1;32m   1930[0m         [38;5;28;01mreturn[39;00m modules[name]
[0;32m-> 1931[0m [38;5;28;01mraise[39;00m [38;5;167;01mAttributeError[39;00m(
[1;32m   1932[0m     [38;5;124mf[39m[38;5;124m"[39m[38;5;124m'[39m[38;5;132;01m{[39;00m[38;5;28mtype[39m([38;5;28mself[39m)[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m'[39m[38;5;124m object has no attribute [39m[38;5;124m'[39m[38;5;132;01m{[39;00mname[38;5;132;01m}[39;00m[38;5;124m'[39m[38;5;124m"[39m
[1;32m   1933[0m )

[0;31mAttributeError[0m: 'LitCNN' object has no attribute 'CNN'


LitCNN(
  (model): Wang2024(
    (conv1): Conv2d(1, 12, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (pool1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (conv2): Conv2d(12, 48, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (pool2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (fc1): Linear(in_features=24576, out_features=96, bias=True)
    (fc2): Linear(in_features=96, out_features=48, bias=True)
    (fc3): Linear(in_features=48, out_features=10, bias=True)
  )
)


Wang2024(
  (conv1): Conv2d(1, 12, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (pool1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(12, 48, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (pool2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (fc1): Linear(in_features=24576, out_features=96, bias=True)
  (fc2): Linear(in_features=96, out_features=48, bias=True)
  (fc3): Linear(in_features=48, out_features=10, bias=True)
)


LitCNN(
  (model): Wang2024(
    (conv1): Conv2d(1, 12, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (pool1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (conv2): Conv2d(12, 48, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (pool2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (fc1): Linear(in_features=24576, out_features=96, bias=True)
    (fc2): Linear(in_features=96, out_features=48, bias=True)
    (fc3): Linear(in_features=48, out_features=10, bias=True)
  )
)

[0;31m---------------------------------------------------------------------------[0m
[0;31mNotImplementedError[0m                       Traceback (most recent call last)
Cell [0;32mIn[11], line 1[0m
[0;32m----> 1[0m [43mmodel[49m[43m([49m[43mX_test[49m[43m[[49m[43m:[49m[38;5;241;43m1[39;49m[43m][49m[38;5;241;43m.[39;49m[43mto[49m[43m([49m[43mdevice[49m[43m)[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1736[0m, in [0;36mModule._wrapped_call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1734[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_compiled_call_impl([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)  [38;5;66;03m# type: ignore[misc][39;00m
[1;32m   1735[0m [38;5;28;01melse[39;00m:
[0;32m-> 1736[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_call_impl[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1747[0m, in [0;36mModule._call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1742[0m [38;5;66;03m# If we don't have any hooks, we want to skip the rest of the logic in[39;00m
[1;32m   1743[0m [38;5;66;03m# this function, and just call forward.[39;00m
[1;32m   1744[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m ([38;5;28mself[39m[38;5;241m.[39m_backward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_backward_pre_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_pre_hooks
[1;32m   1745[0m         [38;5;129;01mor[39;00m _global_backward_pre_hooks [38;5;129;01mor[39;00m _global_backward_hooks
[1;32m   1746[0m         [38;5;129;01mor[39;00m _global_forward_hooks [38;5;129;01mor[39;00m _global_forward_pre_hooks):
[0;32m-> 1747[0m     [38;5;28;01mreturn[39;00m [43mforward_call[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m   1749[0m result [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m   1750[0m called_always_called_hooks [38;5;241m=[39m [38;5;28mset[39m()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/module.py:698[0m, in [0;36mLightningModule.forward[0;34m(self, *args, **kwargs)[0m
[1;32m    686[0m [38;5;129m@override[39m
[1;32m    687[0m [38;5;28;01mdef[39;00m [38;5;21mforward[39m([38;5;28mself[39m, [38;5;241m*[39margs: Any, [38;5;241m*[39m[38;5;241m*[39mkwargs: Any) [38;5;241m-[39m[38;5;241m>[39m Any:
[1;32m    688[0m [38;5;250m    [39m[38;5;124mr[39m[38;5;124;03m"""Same as :meth:`torch.nn.Module.forward`.[39;00m
[1;32m    689[0m
[1;32m    690[0m [38;5;124;03m    Args:[39;00m
[0;32m   (...)[0m
[1;32m    696[0m
[1;32m    697[0m [38;5;124;03m    """[39;00m
[0;32m--> 698[0m     [38;5;28;01mreturn[39;00m [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[43mforward[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:394[0m, in [0;36m_forward_unimplemented[0;34m(self, *input)[0m
[1;32m    383[0m [38;5;28;01mdef[39;00m [38;5;21m_forward_unimplemented[39m([38;5;28mself[39m, [38;5;241m*[39m[38;5;28minput[39m: Any) [38;5;241m-[39m[38;5;241m>[39m [38;5;28;01mNone[39;00m:
[1;32m    384[0m [38;5;250m    [39m[38;5;124mr[39m[38;5;124;03m"""Define the computation performed at every call.[39;00m
[1;32m    385[0m
[1;32m    386[0m [38;5;124;03m    Should be overridden by all subclasses.[39;00m
[0;32m   (...)[0m
[1;32m    392[0m [38;5;124;03m        registered hooks while the latter silently ignores them.[39;00m
[1;32m    393[0m [38;5;124;03m    """[39;00m
[0;32m--> 394[0m     [38;5;28;01mraise[39;00m [38;5;167;01mNotImplementedError[39;00m(
[1;32m    395[0m         [38;5;124mf[39m[38;5;124m'[39m[38;5;124mModule [[39m[38;5;132;01m{[39;00m[38;5;28mtype[39m([38;5;28mself[39m)[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m] is missing the required [39m[38;5;124m"[39m[38;5;124mforward[39m[38;5;124m"[39m[38;5;124m function[39m[38;5;124m'[39m
[1;32m    396[0m     )

[0;31mNotImplementedError[0m: Module [LitCNN] is missing the required "forward" function

[0;31m---------------------------------------------------------------------------[0m
[0;31mRuntimeError[0m                              Traceback (most recent call last)
Cell [0;32mIn[12], line 1[0m
[0;32m----> 1[0m [43mmodel[49m[38;5;241;43m.[39;49m[43mmodel[49m[43m([49m[43mX_test[49m[43m[[49m[43m:[49m[38;5;241;43m1[39;49m[43m][49m[38;5;241;43m.[39;49m[43mto[49m[43m([49m[43mdevice[49m[43m)[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1736[0m, in [0;36mModule._wrapped_call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1734[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_compiled_call_impl([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)  [38;5;66;03m# type: ignore[misc][39;00m
[1;32m   1735[0m [38;5;28;01melse[39;00m:
[0;32m-> 1736[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_call_impl[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1747[0m, in [0;36mModule._call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1742[0m [38;5;66;03m# If we don't have any hooks, we want to skip the rest of the logic in[39;00m
[1;32m   1743[0m [38;5;66;03m# this function, and just call forward.[39;00m
[1;32m   1744[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m ([38;5;28mself[39m[38;5;241m.[39m_backward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_backward_pre_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_pre_hooks
[1;32m   1745[0m         [38;5;129;01mor[39;00m _global_backward_pre_hooks [38;5;129;01mor[39;00m _global_backward_hooks
[1;32m   1746[0m         [38;5;129;01mor[39;00m _global_forward_hooks [38;5;129;01mor[39;00m _global_forward_pre_hooks):
[0;32m-> 1747[0m     [38;5;28;01mreturn[39;00m [43mforward_call[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m   1749[0m result [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m   1750[0m called_always_called_hooks [38;5;241m=[39m [38;5;28mset[39m()

File [0;32m/shared_netapp3_home/home/rogui7909/code/predict_rain_norway/models/model.py:51[0m, in [0;36mWang2024.forward[0;34m(self, x)[0m
[1;32m     50[0m [38;5;28;01mdef[39;00m [38;5;21mforward[39m([38;5;28mself[39m, x):
[0;32m---> 51[0m     x [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mconv1[49m[43m([49m[43mx[49m[43m)[49m
[1;32m     52[0m     x [38;5;241m=[39m nn[38;5;241m.[39mReLU()(x)
[1;32m     53[0m     x [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mpool1(x)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1736[0m, in [0;36mModule._wrapped_call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1734[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_compiled_call_impl([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)  [38;5;66;03m# type: ignore[misc][39;00m
[1;32m   1735[0m [38;5;28;01melse[39;00m:
[0;32m-> 1736[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_call_impl[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1747[0m, in [0;36mModule._call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1742[0m [38;5;66;03m# If we don't have any hooks, we want to skip the rest of the logic in[39;00m
[1;32m   1743[0m [38;5;66;03m# this function, and just call forward.[39;00m
[1;32m   1744[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m ([38;5;28mself[39m[38;5;241m.[39m_backward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_backward_pre_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_pre_hooks
[1;32m   1745[0m         [38;5;129;01mor[39;00m _global_backward_pre_hooks [38;5;129;01mor[39;00m _global_backward_hooks
[1;32m   1746[0m         [38;5;129;01mor[39;00m _global_forward_hooks [38;5;129;01mor[39;00m _global_forward_pre_hooks):
[0;32m-> 1747[0m     [38;5;28;01mreturn[39;00m [43mforward_call[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m   1749[0m result [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m   1750[0m called_always_called_hooks [38;5;241m=[39m [38;5;28mset[39m()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/conv.py:554[0m, in [0;36mConv2d.forward[0;34m(self, input)[0m
[1;32m    553[0m [38;5;28;01mdef[39;00m [38;5;21mforward[39m([38;5;28mself[39m, [38;5;28minput[39m: Tensor) [38;5;241m-[39m[38;5;241m>[39m Tensor:
[0;32m--> 554[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_conv_forward[49m[43m([49m[38;5;28;43minput[39;49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mweight[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mbias[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/conv.py:549[0m, in [0;36mConv2d._conv_forward[0;34m(self, input, weight, bias)[0m
[1;32m    537[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mpadding_mode [38;5;241m!=[39m [38;5;124m"[39m[38;5;124mzeros[39m[38;5;124m"[39m:
[1;32m    538[0m     [38;5;28;01mreturn[39;00m F[38;5;241m.[39mconv2d(
[1;32m    539[0m         F[38;5;241m.[39mpad(
[1;32m    540[0m             [38;5;28minput[39m, [38;5;28mself[39m[38;5;241m.[39m_reversed_padding_repeated_twice, mode[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mpadding_mode
[0;32m   (...)[0m
[1;32m    547[0m         [38;5;28mself[39m[38;5;241m.[39mgroups,
[1;32m    548[0m     )
[0;32m--> 549[0m [38;5;28;01mreturn[39;00m [43mF[49m[38;5;241;43m.[39;49m[43mconv2d[49m[43m([49m
[1;32m    550[0m [43m    [49m[38;5;28;43minput[39;49m[43m,[49m[43m [49m[43mweight[49m[43m,[49m[43m [49m[43mbias[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mstride[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mpadding[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdilation[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mgroups[49m
[1;32m    551[0m [43m[49m[43m)[49m

[0;31mRuntimeError[0m: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same


tensor([[-3.1965, -1.0599, -0.3472,  0.0708,  0.2640,  0.4716,  0.6345,  0.6310,
          0.4907, -0.1798]], grad_fn=<AddmmBackward0>)

[23;0t
