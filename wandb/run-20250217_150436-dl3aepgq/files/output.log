LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name    | Type     | Params | Mode
---------------------------------------------
0 | model   | Wang2024 | 7.4 M  | train
1 | loss_fn | MSELoss  | 0      | train
---------------------------------------------
7.4 M     Trainable params
0         Non-trainable params
7.4 M     Total params
29.532    Total estimated model params size (MB)
9         Modules in train mode
0         Modules in eval mode
Epoch 19: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:07<00:00, 13.61it/s, v_num=epgq]
/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=71` in the `DataLoader` to improve performance.
/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=71` in the `DataLoader` to improve performance.
Testing DataLoader 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:00<00:00, 75.97it/s]
`Trainer.fit` stopped: `max_epochs=20` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=71` in the `DataLoader` to improve performance.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       Test metric             DataLoader 0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        test/loss            14.19882869720459
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


[0;31m---------------------------------------------------------------------------[0m
[0;31mTypeError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[3], line 1[0m
[0;32m----> 1[0m test [38;5;241m=[39m [43mLitCNN[49m[38;5;241;43m.[39;49m[43mload_from_checkpoint[49m[43m([49m[38;5;124;43m'[39;49m[38;5;124;43mu850_regression.ckpt[39;49m[38;5;124;43m'[39;49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/utilities/model_helpers.py:125[0m, in [0;36m_restricted_classmethod_impl.__get__.<locals>.wrapper[0;34m(*args, **kwargs)[0m
[1;32m    120[0m [38;5;28;01mif[39;00m instance [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m is_scripting:
[1;32m    121[0m     [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m(
[1;32m    122[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;124mThe classmethod `[39m[38;5;132;01m{[39;00m[38;5;28mcls[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m.[39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39mmethod[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m` cannot be called on an instance.[39m[38;5;124m"[39m
[1;32m    123[0m         [38;5;124m"[39m[38;5;124m Please call it on the class type and make sure the return value is used.[39m[38;5;124m"[39m
[1;32m    124[0m     )
[0;32m--> 125[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mmethod[49m[43m([49m[38;5;28;43mcls[39;49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/module.py:1581[0m, in [0;36mLightningModule.load_from_checkpoint[0;34m(cls, checkpoint_path, map_location, hparams_file, strict, **kwargs)[0m
[1;32m   1492[0m [38;5;129m@_restricted_classmethod[39m
[1;32m   1493[0m [38;5;28;01mdef[39;00m [38;5;21mload_from_checkpoint[39m(
[1;32m   1494[0m     [38;5;28mcls[39m,
[0;32m   (...)[0m
[1;32m   1499[0m     [38;5;241m*[39m[38;5;241m*[39mkwargs: Any,
[1;32m   1500[0m ) [38;5;241m-[39m[38;5;241m>[39m Self:
[1;32m   1501[0m [38;5;250m    [39m[38;5;124mr[39m[38;5;124;03m"""Primary way of loading a model from a checkpoint. When Lightning saves a checkpoint it stores the arguments[39;00m
[1;32m   1502[0m [38;5;124;03m    passed to ``__init__``  in the checkpoint under ``"hyper_parameters"``.[39;00m
[1;32m   1503[0m
[0;32m   (...)[0m
[1;32m   1579[0m
[1;32m   1580[0m [38;5;124;03m    """[39;00m
[0;32m-> 1581[0m     loaded [38;5;241m=[39m [43m_load_from_checkpoint[49m[43m([49m
[1;32m   1582[0m [43m        [49m[38;5;28;43mcls[39;49m[43m,[49m
[1;32m   1583[0m [43m        [49m[43mcheckpoint_path[49m[43m,[49m
[1;32m   1584[0m [43m        [49m[43mmap_location[49m[43m,[49m
[1;32m   1585[0m [43m        [49m[43mhparams_file[49m[43m,[49m
[1;32m   1586[0m [43m        [49m[43mstrict[49m[43m,[49m
[1;32m   1587[0m [43m        [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
[1;32m   1588[0m [43m    [49m[43m)[49m
[1;32m   1589[0m     [38;5;28;01mreturn[39;00m cast(Self, loaded)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/saving.py:91[0m, in [0;36m_load_from_checkpoint[0;34m(cls, checkpoint_path, map_location, hparams_file, strict, **kwargs)[0m
[1;32m     89[0m     [38;5;28;01mreturn[39;00m _load_state([38;5;28mcls[39m, checkpoint, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[1;32m     90[0m [38;5;28;01mif[39;00m [38;5;28missubclass[39m([38;5;28mcls[39m, pl[38;5;241m.[39mLightningModule):
[0;32m---> 91[0m     model [38;5;241m=[39m [43m_load_state[49m[43m([49m[38;5;28;43mcls[39;49m[43m,[49m[43m [49m[43mcheckpoint[49m[43m,[49m[43m [49m[43mstrict[49m[38;5;241;43m=[39;49m[43mstrict[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     92[0m     state_dict [38;5;241m=[39m checkpoint[[38;5;124m"[39m[38;5;124mstate_dict[39m[38;5;124m"[39m]
[1;32m     93[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m state_dict:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/saving.py:165[0m, in [0;36m_load_state[0;34m(cls, checkpoint, strict, **cls_kwargs_new)[0m
[1;32m    161[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m cls_spec[38;5;241m.[39mvarkw:
[1;32m    162[0m     [38;5;66;03m# filter kwargs according to class init unless it allows any argument via kwargs[39;00m
[1;32m    163[0m     _cls_kwargs [38;5;241m=[39m {k: v [38;5;28;01mfor[39;00m k, v [38;5;129;01min[39;00m _cls_kwargs[38;5;241m.[39mitems() [38;5;28;01mif[39;00m k [38;5;129;01min[39;00m cls_init_args_name}
[0;32m--> 165[0m obj [38;5;241m=[39m instantiator([38;5;28mcls[39m, _cls_kwargs) [38;5;28;01mif[39;00m instantiator [38;5;28;01melse[39;00m [38;5;28;43mcls[39;49m[43m([49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43m_cls_kwargs[49m[43m)[49m
[1;32m    167[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(obj, pl[38;5;241m.[39mLightningDataModule):
[1;32m    168[0m     [38;5;28;01mif[39;00m obj[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__qualname__[39m [38;5;129;01min[39;00m checkpoint:

[0;31mTypeError[0m: LitCNN.__init__() missing 1 required positional argument: 'model'
/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/configuration_validator.py:70: You defined a `validation_step` but have no `val_dataloader`. Skipping val loop.
/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:654: Checkpoint directory ./Predict-rain-WNorway/dl3aepgq/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name    | Type     | Params | Mode
--------------------------------------------
0 | model   | Wang2024 | 7.4 M  | eval
1 | loss_fn | MSELoss  | 0      | eval
--------------------------------------------
7.4 M     Trainable params
0         Non-trainable params
7.4 M     Total params
29.532    Total estimated model params size (MB)
0         Modules in train mode
9         Modules in eval mode

[0;31m---------------------------------------------------------------------------[0m
[0;31mMisconfigurationException[0m                 Traceback (most recent call last)
Cell [0;32mIn[4], line 1[0m
[0;32m----> 1[0m [43mtrainer[49m[38;5;241;43m.[39;49m[43mfit[49m[43m([49m[43mmodel[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:539[0m, in [0;36mTrainer.fit[0;34m(self, model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)[0m
[1;32m    537[0m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstatus [38;5;241m=[39m TrainerStatus[38;5;241m.[39mRUNNING
[1;32m    538[0m [38;5;28mself[39m[38;5;241m.[39mtraining [38;5;241m=[39m [38;5;28;01mTrue[39;00m
[0;32m--> 539[0m [43mcall[49m[38;5;241;43m.[39;49m[43m_call_and_handle_interrupt[49m[43m([49m
[1;32m    540[0m [43m    [49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_fit_impl[49m[43m,[49m[43m [49m[43mmodel[49m[43m,[49m[43m [49m[43mtrain_dataloaders[49m[43m,[49m[43m [49m[43mval_dataloaders[49m[43m,[49m[43m [49m[43mdatamodule[49m[43m,[49m[43m [49m[43mckpt_path[49m
[1;32m    541[0m [43m[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/call.py:47[0m, in [0;36m_call_and_handle_interrupt[0;34m(trainer, trainer_fn, *args, **kwargs)[0m
[1;32m     45[0m     [38;5;28;01mif[39;00m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mlauncher [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m     46[0m         [38;5;28;01mreturn[39;00m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mlauncher[38;5;241m.[39mlaunch(trainer_fn, [38;5;241m*[39margs, trainer[38;5;241m=[39mtrainer, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[0;32m---> 47[0m     [38;5;28;01mreturn[39;00m [43mtrainer_fn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     49[0m [38;5;28;01mexcept[39;00m _TunerExitException:
[1;32m     50[0m     _call_teardown_hook(trainer)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:575[0m, in [0;36mTrainer._fit_impl[0;34m(self, model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)[0m
[1;32m    568[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfn [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[1;32m    569[0m ckpt_path [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_checkpoint_connector[38;5;241m.[39m_select_ckpt_path(
[1;32m    570[0m     [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfn,
[1;32m    571[0m     ckpt_path,
[1;32m    572[0m     model_provided[38;5;241m=[39m[38;5;28;01mTrue[39;00m,
[1;32m    573[0m     model_connected[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mlightning_module [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m,
[1;32m    574[0m )
[0;32m--> 575[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[43mckpt_path[49m[38;5;241;43m=[39;49m[43mckpt_path[49m[43m)[49m
[1;32m    577[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstopped
[1;32m    578[0m [38;5;28mself[39m[38;5;241m.[39mtraining [38;5;241m=[39m [38;5;28;01mFalse[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:982[0m, in [0;36mTrainer._run[0;34m(self, model, ckpt_path)[0m
[1;32m    977[0m [38;5;28mself[39m[38;5;241m.[39m_signal_connector[38;5;241m.[39mregister_signal_handlers()
[1;32m    979[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    980[0m [38;5;66;03m# RUN THE TRAINER[39;00m
[1;32m    981[0m [38;5;66;03m# ----------------------------[39;00m
[0;32m--> 982[0m results [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run_stage[49m[43m([49m[43m)[49m
[1;32m    984[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    985[0m [38;5;66;03m# POST-Training CLEAN UP[39;00m
[1;32m    986[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    987[0m log[38;5;241m.[39mdebug([38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m: trainer tearing down[39m[38;5;124m"[39m)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:1026[0m, in [0;36mTrainer._run_stage[0;34m(self)[0m
[1;32m   1024[0m         [38;5;28mself[39m[38;5;241m.[39m_run_sanity_check()
[1;32m   1025[0m     [38;5;28;01mwith[39;00m torch[38;5;241m.[39mautograd[38;5;241m.[39mset_detect_anomaly([38;5;28mself[39m[38;5;241m.[39m_detect_anomaly):
[0;32m-> 1026[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mfit_loop[49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[43m)[49m
[1;32m   1027[0m     [38;5;28;01mreturn[39;00m [38;5;28;01mNone[39;00m
[1;32m   1028[0m [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m([38;5;124mf[39m[38;5;124m"[39m[38;5;124mUnexpected state [39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39mstate[38;5;132;01m}[39;00m[38;5;124m"[39m)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/fit_loop.py:208[0m, in [0;36m_FitLoop.run[0;34m(self)[0m
[1;32m    207[0m [38;5;28;01mdef[39;00m [38;5;21mrun[39m([38;5;28mself[39m) [38;5;241m-[39m[38;5;241m>[39m [38;5;28;01mNone[39;00m:
[0;32m--> 208[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msetup_data[49m[43m([49m[43m)[49m
[1;32m    209[0m     [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mskip:
[1;32m    210[0m         [38;5;28;01mreturn[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/fit_loop.py:237[0m, in [0;36m_FitLoop.setup_data[0;34m(self)[0m
[1;32m    234[0m log[38;5;241m.[39mdebug([38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m: resetting train dataloader[39m[38;5;124m"[39m)
[1;32m    236[0m source [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_data_source
[0;32m--> 237[0m train_dataloader [38;5;241m=[39m [43m_request_dataloader[49m[43m([49m[43msource[49m[43m)[49m
[1;32m    238[0m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mbarrier([38;5;124m"[39m[38;5;124mtrain_dataloader()[39m[38;5;124m"[39m)
[1;32m    240[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28misinstance[39m(train_dataloader, CombinedLoader):

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:326[0m, in [0;36m_request_dataloader[0;34m(data_source)[0m
[1;32m    315[0m [38;5;250m[39m[38;5;124;03m"""Requests a dataloader by calling dataloader hooks corresponding to the given stage.[39;00m
[1;32m    316[0m
[1;32m    317[0m [38;5;124;03mReturns:[39;00m
[1;32m    318[0m [38;5;124;03m    The requested dataloader[39;00m
[1;32m    319[0m
[1;32m    320[0m [38;5;124;03m"""[39;00m
[1;32m    321[0m [38;5;28;01mwith[39;00m _replace_dunder_methods(DataLoader, [38;5;124m"[39m[38;5;124mdataset[39m[38;5;124m"[39m), _replace_dunder_methods(BatchSampler):
[1;32m    322[0m     [38;5;66;03m# under this context manager, the arguments passed to `DataLoader.__init__` will be captured and saved as[39;00m
[1;32m    323[0m     [38;5;66;03m# attributes on the instance in case the dataloader needs to be re-instantiated later by Lightning.[39;00m
[1;32m    324[0m     [38;5;66;03m# Also, it records all attribute setting and deletion using patched `__setattr__` and `__delattr__`[39;00m
[1;32m    325[0m     [38;5;66;03m# methods so that the re-instantiated object is as close to the original as possible.[39;00m
[0;32m--> 326[0m     [38;5;28;01mreturn[39;00m [43mdata_source[49m[38;5;241;43m.[39;49m[43mdataloader[49m[43m([49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:290[0m, in [0;36m_DataLoaderSource.dataloader[0;34m(self)[0m
[1;32m    284[0m [38;5;250m[39m[38;5;124;03m"""Returns the dataloader from the source.[39;00m
[1;32m    285[0m
[1;32m    286[0m [38;5;124;03mIf the source is a module, the method with the corresponding :attr:`name` gets called.[39;00m
[1;32m    287[0m
[1;32m    288[0m [38;5;124;03m"""[39;00m
[1;32m    289[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m([38;5;28mself[39m[38;5;241m.[39minstance, pl[38;5;241m.[39mLightningModule):
[0;32m--> 290[0m     [38;5;28;01mreturn[39;00m [43mcall[49m[38;5;241;43m.[39;49m[43m_call_lightning_module_hook[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43minstance[49m[38;5;241;43m.[39;49m[43mtrainer[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mname[49m[43m,[49m[43m [49m[43mpl_module[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43minstance[49m[43m)[49m
[1;32m    291[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m([38;5;28mself[39m[38;5;241m.[39minstance, pl[38;5;241m.[39mLightningDataModule):
[1;32m    292[0m     [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39minstance[38;5;241m.[39mtrainer [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/call.py:171[0m, in [0;36m_call_lightning_module_hook[0;34m(trainer, hook_name, pl_module, *args, **kwargs)[0m
[1;32m    168[0m pl_module[38;5;241m.[39m_current_fx_name [38;5;241m=[39m hook_name
[1;32m    170[0m [38;5;28;01mwith[39;00m trainer[38;5;241m.[39mprofiler[38;5;241m.[39mprofile([38;5;124mf[39m[38;5;124m"[39m[38;5;124m[LightningModule][39m[38;5;132;01m{[39;00mpl_module[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m.[39m[38;5;132;01m{[39;00mhook_name[38;5;132;01m}[39;00m[38;5;124m"[39m):
[0;32m--> 171[0m     output [38;5;241m=[39m [43mfn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    173[0m [38;5;66;03m# restore current_fx when nested context[39;00m
[1;32m    174[0m pl_module[38;5;241m.[39m_current_fx_name [38;5;241m=[39m prev_fx_name

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/hooks.py:482[0m, in [0;36mDataHooks.train_dataloader[0;34m(self)[0m
[1;32m    455[0m [38;5;28;01mdef[39;00m [38;5;21mtrain_dataloader[39m([38;5;28mself[39m) [38;5;241m-[39m[38;5;241m>[39m TRAIN_DATALOADERS:
[1;32m    456[0m [38;5;250m    [39m[38;5;124;03m"""An iterable or collection of iterables specifying training samples.[39;00m
[1;32m    457[0m
[1;32m    458[0m [38;5;124;03m    For more information about multiple dataloaders, see this :ref:`section <multiple-dataloaders>`.[39;00m
[0;32m   (...)[0m
[1;32m    480[0m
[1;32m    481[0m [38;5;124;03m    """[39;00m
[0;32m--> 482[0m     [38;5;28;01mraise[39;00m MisconfigurationException([38;5;124m"[39m[38;5;124m`train_dataloader` must be implemented to be used with the Lightning Trainer[39m[38;5;124m"[39m)

[0;31mMisconfigurationException[0m: `train_dataloader` must be implemented to be used with the Lightning Trainer


[0;31m---------------------------------------------------------------------------[0m
[0;31mRuntimeError[0m                              Traceback (most recent call last)
Cell [0;32mIn[6], line 1[0m
[0;32m----> 1[0m test [38;5;241m=[39m [43mLitCNN[49m[38;5;241;43m.[39;49m[43mload_from_checkpoint[49m[43m([49m[38;5;124;43m'[39;49m[38;5;124;43mu850_regression.ckpt[39;49m[38;5;124;43m'[39;49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/utilities/model_helpers.py:125[0m, in [0;36m_restricted_classmethod_impl.__get__.<locals>.wrapper[0;34m(*args, **kwargs)[0m
[1;32m    120[0m [38;5;28;01mif[39;00m instance [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m is_scripting:
[1;32m    121[0m     [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m(
[1;32m    122[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;124mThe classmethod `[39m[38;5;132;01m{[39;00m[38;5;28mcls[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m.[39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39mmethod[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m` cannot be called on an instance.[39m[38;5;124m"[39m
[1;32m    123[0m         [38;5;124m"[39m[38;5;124m Please call it on the class type and make sure the return value is used.[39m[38;5;124m"[39m
[1;32m    124[0m     )
[0;32m--> 125[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mmethod[49m[43m([49m[38;5;28;43mcls[39;49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/module.py:1581[0m, in [0;36mLightningModule.load_from_checkpoint[0;34m(cls, checkpoint_path, map_location, hparams_file, strict, **kwargs)[0m
[1;32m   1492[0m [38;5;129m@_restricted_classmethod[39m
[1;32m   1493[0m [38;5;28;01mdef[39;00m [38;5;21mload_from_checkpoint[39m(
[1;32m   1494[0m     [38;5;28mcls[39m,
[0;32m   (...)[0m
[1;32m   1499[0m     [38;5;241m*[39m[38;5;241m*[39mkwargs: Any,
[1;32m   1500[0m ) [38;5;241m-[39m[38;5;241m>[39m Self:
[1;32m   1501[0m [38;5;250m    [39m[38;5;124mr[39m[38;5;124;03m"""Primary way of loading a model from a checkpoint. When Lightning saves a checkpoint it stores the arguments[39;00m
[1;32m   1502[0m [38;5;124;03m    passed to ``__init__``  in the checkpoint under ``"hyper_parameters"``.[39;00m
[1;32m   1503[0m
[0;32m   (...)[0m
[1;32m   1579[0m
[1;32m   1580[0m [38;5;124;03m    """[39;00m
[0;32m-> 1581[0m     loaded [38;5;241m=[39m [43m_load_from_checkpoint[49m[43m([49m
[1;32m   1582[0m [43m        [49m[38;5;28;43mcls[39;49m[43m,[49m
[1;32m   1583[0m [43m        [49m[43mcheckpoint_path[49m[43m,[49m
[1;32m   1584[0m [43m        [49m[43mmap_location[49m[43m,[49m
[1;32m   1585[0m [43m        [49m[43mhparams_file[49m[43m,[49m
[1;32m   1586[0m [43m        [49m[43mstrict[49m[43m,[49m
[1;32m   1587[0m [43m        [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
[1;32m   1588[0m [43m    [49m[43m)[49m
[1;32m   1589[0m     [38;5;28;01mreturn[39;00m cast(Self, loaded)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/saving.py:91[0m, in [0;36m_load_from_checkpoint[0;34m(cls, checkpoint_path, map_location, hparams_file, strict, **kwargs)[0m
[1;32m     89[0m     [38;5;28;01mreturn[39;00m _load_state([38;5;28mcls[39m, checkpoint, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[1;32m     90[0m [38;5;28;01mif[39;00m [38;5;28missubclass[39m([38;5;28mcls[39m, pl[38;5;241m.[39mLightningModule):
[0;32m---> 91[0m     model [38;5;241m=[39m [43m_load_state[49m[43m([49m[38;5;28;43mcls[39;49m[43m,[49m[43m [49m[43mcheckpoint[49m[43m,[49m[43m [49m[43mstrict[49m[38;5;241;43m=[39;49m[43mstrict[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     92[0m     state_dict [38;5;241m=[39m checkpoint[[38;5;124m"[39m[38;5;124mstate_dict[39m[38;5;124m"[39m]
[1;32m     93[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m state_dict:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/saving.py:187[0m, in [0;36m_load_state[0;34m(cls, checkpoint, strict, **cls_kwargs_new)[0m
[1;32m    184[0m     obj[38;5;241m.[39mon_load_checkpoint(checkpoint)
[1;32m    186[0m [38;5;66;03m# load the state_dict on the model automatically[39;00m
[0;32m--> 187[0m keys [38;5;241m=[39m [43mobj[49m[38;5;241;43m.[39;49m[43mload_state_dict[49m[43m([49m[43mcheckpoint[49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43mstate_dict[39;49m[38;5;124;43m"[39;49m[43m][49m[43m,[49m[43m [49m[43mstrict[49m[38;5;241;43m=[39;49m[43mstrict[49m[43m)[49m
[1;32m    189[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m strict:
[1;32m    190[0m     [38;5;28;01mif[39;00m keys[38;5;241m.[39mmissing_keys:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:2584[0m, in [0;36mModule.load_state_dict[0;34m(self, state_dict, strict, assign)[0m
[1;32m   2576[0m         error_msgs[38;5;241m.[39minsert(
[1;32m   2577[0m             [38;5;241m0[39m,
[1;32m   2578[0m             [38;5;124m"[39m[38;5;124mMissing key(s) in state_dict: [39m[38;5;132;01m{}[39;00m[38;5;124m. [39m[38;5;124m"[39m[38;5;241m.[39mformat(
[1;32m   2579[0m                 [38;5;124m"[39m[38;5;124m, [39m[38;5;124m"[39m[38;5;241m.[39mjoin([38;5;124mf[39m[38;5;124m'[39m[38;5;124m"[39m[38;5;132;01m{[39;00mk[38;5;132;01m}[39;00m[38;5;124m"[39m[38;5;124m'[39m [38;5;28;01mfor[39;00m k [38;5;129;01min[39;00m missing_keys)
[1;32m   2580[0m             ),
[1;32m   2581[0m         )
[1;32m   2583[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m(error_msgs) [38;5;241m>[39m [38;5;241m0[39m:
[0;32m-> 2584[0m     [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m(
[1;32m   2585[0m         [38;5;124m"[39m[38;5;124mError(s) in loading state_dict for [39m[38;5;132;01m{}[39;00m[38;5;124m:[39m[38;5;130;01m\n[39;00m[38;5;130;01m\t[39;00m[38;5;132;01m{}[39;00m[38;5;124m"[39m[38;5;241m.[39mformat(
[1;32m   2586[0m             [38;5;28mself[39m[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m, [38;5;124m"[39m[38;5;130;01m\n[39;00m[38;5;130;01m\t[39;00m[38;5;124m"[39m[38;5;241m.[39mjoin(error_msgs)
[1;32m   2587[0m         )
[1;32m   2588[0m     )
[1;32m   2589[0m [38;5;28;01mreturn[39;00m _IncompatibleKeys(missing_keys, unexpected_keys)

[0;31mRuntimeError[0m: Error(s) in loading state_dict for LitCNN:
	Unexpected key(s) in state_dict: "model.conv1.weight", "model.conv1.bias", "model.conv2.weight", "model.conv2.bias", "model.fc1.weight", "model.fc1.bias", "model.fc2.weight", "model.fc2.bias", "model.fc3.weight", "model.fc3.bias".

[0;31m---------------------------------------------------------------------------[0m
[0;31mRuntimeError[0m                              Traceback (most recent call last)
Cell [0;32mIn[7], line 1[0m
[0;32m----> 1[0m test [38;5;241m=[39m [43mLitCNN[49m[38;5;241;43m.[39;49m[43mload_from_checkpoint[49m[43m([49m[38;5;124;43m'[39;49m[38;5;124;43mu850_regression.ckpt[39;49m[38;5;124;43m'[39;49m[43m)[49m
[1;32m      2[0m [38;5;28;01mclass[39;00m [38;5;21;01mLitCNN[39;00m(L[38;5;241m.[39mLightningModule):
[1;32m      3[0m     [38;5;28;01mdef[39;00m [38;5;21m__init__[39m([38;5;28mself[39m, model,
[1;32m      4[0m                  type_prediction[38;5;241m=[39m[38;5;124m'[39m[38;5;124mquantiles[39m[38;5;124m'[39m,
[1;32m      5[0m                  learning_rate[38;5;241m=[39m[38;5;241m1e-3[39m,
[1;32m      6[0m                  loss[38;5;241m=[39mDistribLoss()):

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/utilities/model_helpers.py:125[0m, in [0;36m_restricted_classmethod_impl.__get__.<locals>.wrapper[0;34m(*args, **kwargs)[0m
[1;32m    120[0m [38;5;28;01mif[39;00m instance [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m is_scripting:
[1;32m    121[0m     [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m(
[1;32m    122[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;124mThe classmethod `[39m[38;5;132;01m{[39;00m[38;5;28mcls[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m.[39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39mmethod[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m` cannot be called on an instance.[39m[38;5;124m"[39m
[1;32m    123[0m         [38;5;124m"[39m[38;5;124m Please call it on the class type and make sure the return value is used.[39m[38;5;124m"[39m
[1;32m    124[0m     )
[0;32m--> 125[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mmethod[49m[43m([49m[38;5;28;43mcls[39;49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/module.py:1581[0m, in [0;36mLightningModule.load_from_checkpoint[0;34m(cls, checkpoint_path, map_location, hparams_file, strict, **kwargs)[0m
[1;32m   1492[0m [38;5;129m@_restricted_classmethod[39m
[1;32m   1493[0m [38;5;28;01mdef[39;00m [38;5;21mload_from_checkpoint[39m(
[1;32m   1494[0m     [38;5;28mcls[39m,
[0;32m   (...)[0m
[1;32m   1499[0m     [38;5;241m*[39m[38;5;241m*[39mkwargs: Any,
[1;32m   1500[0m ) [38;5;241m-[39m[38;5;241m>[39m Self:
[1;32m   1501[0m [38;5;250m    [39m[38;5;124mr[39m[38;5;124;03m"""Primary way of loading a model from a checkpoint. When Lightning saves a checkpoint it stores the arguments[39;00m
[1;32m   1502[0m [38;5;124;03m    passed to ``__init__``  in the checkpoint under ``"hyper_parameters"``.[39;00m
[1;32m   1503[0m
[0;32m   (...)[0m
[1;32m   1579[0m
[1;32m   1580[0m [38;5;124;03m    """[39;00m
[0;32m-> 1581[0m     loaded [38;5;241m=[39m [43m_load_from_checkpoint[49m[43m([49m
[1;32m   1582[0m [43m        [49m[38;5;28;43mcls[39;49m[43m,[49m
[1;32m   1583[0m [43m        [49m[43mcheckpoint_path[49m[43m,[49m
[1;32m   1584[0m [43m        [49m[43mmap_location[49m[43m,[49m
[1;32m   1585[0m [43m        [49m[43mhparams_file[49m[43m,[49m
[1;32m   1586[0m [43m        [49m[43mstrict[49m[43m,[49m
[1;32m   1587[0m [43m        [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
[1;32m   1588[0m [43m    [49m[43m)[49m
[1;32m   1589[0m     [38;5;28;01mreturn[39;00m cast(Self, loaded)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/saving.py:91[0m, in [0;36m_load_from_checkpoint[0;34m(cls, checkpoint_path, map_location, hparams_file, strict, **kwargs)[0m
[1;32m     89[0m     [38;5;28;01mreturn[39;00m _load_state([38;5;28mcls[39m, checkpoint, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[1;32m     90[0m [38;5;28;01mif[39;00m [38;5;28missubclass[39m([38;5;28mcls[39m, pl[38;5;241m.[39mLightningModule):
[0;32m---> 91[0m     model [38;5;241m=[39m [43m_load_state[49m[43m([49m[38;5;28;43mcls[39;49m[43m,[49m[43m [49m[43mcheckpoint[49m[43m,[49m[43m [49m[43mstrict[49m[38;5;241;43m=[39;49m[43mstrict[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     92[0m     state_dict [38;5;241m=[39m checkpoint[[38;5;124m"[39m[38;5;124mstate_dict[39m[38;5;124m"[39m]
[1;32m     93[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m state_dict:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/saving.py:187[0m, in [0;36m_load_state[0;34m(cls, checkpoint, strict, **cls_kwargs_new)[0m
[1;32m    184[0m     obj[38;5;241m.[39mon_load_checkpoint(checkpoint)
[1;32m    186[0m [38;5;66;03m# load the state_dict on the model automatically[39;00m
[0;32m--> 187[0m keys [38;5;241m=[39m [43mobj[49m[38;5;241;43m.[39;49m[43mload_state_dict[49m[43m([49m[43mcheckpoint[49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43mstate_dict[39;49m[38;5;124;43m"[39;49m[43m][49m[43m,[49m[43m [49m[43mstrict[49m[38;5;241;43m=[39;49m[43mstrict[49m[43m)[49m
[1;32m    189[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m strict:
[1;32m    190[0m     [38;5;28;01mif[39;00m keys[38;5;241m.[39mmissing_keys:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:2584[0m, in [0;36mModule.load_state_dict[0;34m(self, state_dict, strict, assign)[0m
[1;32m   2576[0m         error_msgs[38;5;241m.[39minsert(
[1;32m   2577[0m             [38;5;241m0[39m,
[1;32m   2578[0m             [38;5;124m"[39m[38;5;124mMissing key(s) in state_dict: [39m[38;5;132;01m{}[39;00m[38;5;124m. [39m[38;5;124m"[39m[38;5;241m.[39mformat(
[1;32m   2579[0m                 [38;5;124m"[39m[38;5;124m, [39m[38;5;124m"[39m[38;5;241m.[39mjoin([38;5;124mf[39m[38;5;124m'[39m[38;5;124m"[39m[38;5;132;01m{[39;00mk[38;5;132;01m}[39;00m[38;5;124m"[39m[38;5;124m'[39m [38;5;28;01mfor[39;00m k [38;5;129;01min[39;00m missing_keys)
[1;32m   2580[0m             ),
[1;32m   2581[0m         )
[1;32m   2583[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m(error_msgs) [38;5;241m>[39m [38;5;241m0[39m:
[0;32m-> 2584[0m     [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m(
[1;32m   2585[0m         [38;5;124m"[39m[38;5;124mError(s) in loading state_dict for [39m[38;5;132;01m{}[39;00m[38;5;124m:[39m[38;5;130;01m\n[39;00m[38;5;130;01m\t[39;00m[38;5;132;01m{}[39;00m[38;5;124m"[39m[38;5;241m.[39mformat(
[1;32m   2586[0m             [38;5;28mself[39m[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m, [38;5;124m"[39m[38;5;130;01m\n[39;00m[38;5;130;01m\t[39;00m[38;5;124m"[39m[38;5;241m.[39mjoin(error_msgs)
[1;32m   2587[0m         )
[1;32m   2588[0m     )
[1;32m   2589[0m [38;5;28;01mreturn[39;00m _IncompatibleKeys(missing_keys, unexpected_keys)

[0;31mRuntimeError[0m: Error(s) in loading state_dict for LitCNN:
	Unexpected key(s) in state_dict: "model.conv1.weight", "model.conv1.bias", "model.conv2.weight", "model.conv2.bias", "model.fc1.weight", "model.fc1.bias", "model.fc2.weight", "model.fc2.bias", "model.fc3.weight", "model.fc3.bias".





LitCNN(
  (model): Wang2024(
    (conv1): Conv2d(1, 12, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (pool1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (conv2): Conv2d(12, 48, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (pool2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (fc1): Linear(in_features=76800, out_features=96, bias=True)
    (fc2): Linear(in_features=96, out_features=48, bias=True)
    (fc3): Linear(in_features=48, out_features=1, bias=True)
  )
  (loss_fn): DistribLoss()
)

[23;0t
