LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name  | Type       | Params | Mode
---------------------------------------------
0 | model | Sequential | 525 K  | train
---------------------------------------------
525 K     Trainable params
0         Non-trainable params
525 K     Total params
2.100     Total estimated model params size (MB)
4         Modules in train mode
0         Modules in eval mode
Sanity Checking: |                                                                                   | 0/? [00:00<?, ?it/s][0;31m---------------------------------------------------------------------------[0m
[0;31mTypeError[0m                                 Traceback (most recent call last)
File [0;32m/shared_netapp3_home/home/rogui7909/code/predict_rain_norway/rain_lighting.py:143[0m
[1;32m    127[0m [38;5;66;03m# wandb.init([39;00m
[1;32m    128[0m [38;5;66;03m#     # set the wandb project where this run will be logged[39;00m
[1;32m    129[0m [38;5;66;03m#     project="el-testo",[39;00m
[0;32m   (...)[0m
[1;32m    138[0m [38;5;66;03m# )[39;00m
[1;32m    139[0m [38;5;66;03m# wandb.stop[39;00m
[1;32m    141[0m trainer [38;5;241m=[39m L[38;5;241m.[39mTrainer(limit_train_batches[38;5;241m=[39m[38;5;241m100[39m, max_epochs[38;5;241m=[39mnum_epochs, logger[38;5;241m=[39mwandb_logger, log_every_n_steps[38;5;241m=[39m[38;5;241m1[39m)
[0;32m--> 143[0m [43mtrainer[49m[38;5;241;43m.[39;49m[43mfit[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[43mtrain_loader[49m[43m,[49m[43m [49m[43mvalid_loader[49m[43m)[49m
[1;32m    146[0m model[38;5;241m.[39meval()
[1;32m    147[0m trainer[38;5;241m.[39mtest(model, dataloaders[38;5;241m=[39mtest_loader)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:539[0m, in [0;36mTrainer.fit[0;34m(self, model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)[0m
[1;32m    537[0m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstatus [38;5;241m=[39m TrainerStatus[38;5;241m.[39mRUNNING
[1;32m    538[0m [38;5;28mself[39m[38;5;241m.[39mtraining [38;5;241m=[39m [38;5;28;01mTrue[39;00m
[0;32m--> 539[0m [43mcall[49m[38;5;241;43m.[39;49m[43m_call_and_handle_interrupt[49m[43m([49m
[1;32m    540[0m [43m    [49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_fit_impl[49m[43m,[49m[43m [49m[43mmodel[49m[43m,[49m[43m [49m[43mtrain_dataloaders[49m[43m,[49m[43m [49m[43mval_dataloaders[49m[43m,[49m[43m [49m[43mdatamodule[49m[43m,[49m[43m [49m[43mckpt_path[49m
[1;32m    541[0m [43m[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/call.py:47[0m, in [0;36m_call_and_handle_interrupt[0;34m(trainer, trainer_fn, *args, **kwargs)[0m
[1;32m     45[0m     [38;5;28;01mif[39;00m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mlauncher [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m     46[0m         [38;5;28;01mreturn[39;00m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mlauncher[38;5;241m.[39mlaunch(trainer_fn, [38;5;241m*[39margs, trainer[38;5;241m=[39mtrainer, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[0;32m---> 47[0m     [38;5;28;01mreturn[39;00m [43mtrainer_fn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     49[0m [38;5;28;01mexcept[39;00m _TunerExitException:
[1;32m     50[0m     _call_teardown_hook(trainer)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:575[0m, in [0;36mTrainer._fit_impl[0;34m(self, model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)[0m
[1;32m    568[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfn [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[1;32m    569[0m ckpt_path [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_checkpoint_connector[38;5;241m.[39m_select_ckpt_path(
[1;32m    570[0m     [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfn,
[1;32m    571[0m     ckpt_path,
[1;32m    572[0m     model_provided[38;5;241m=[39m[38;5;28;01mTrue[39;00m,
[1;32m    573[0m     model_connected[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mlightning_module [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m,
[1;32m    574[0m )
[0;32m--> 575[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[43mckpt_path[49m[38;5;241;43m=[39;49m[43mckpt_path[49m[43m)[49m
[1;32m    577[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstopped
[1;32m    578[0m [38;5;28mself[39m[38;5;241m.[39mtraining [38;5;241m=[39m [38;5;28;01mFalse[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:982[0m, in [0;36mTrainer._run[0;34m(self, model, ckpt_path)[0m
[1;32m    977[0m [38;5;28mself[39m[38;5;241m.[39m_signal_connector[38;5;241m.[39mregister_signal_handlers()
[1;32m    979[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    980[0m [38;5;66;03m# RUN THE TRAINER[39;00m
[1;32m    981[0m [38;5;66;03m# ----------------------------[39;00m
[0;32m--> 982[0m results [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run_stage[49m[43m([49m[43m)[49m
[1;32m    984[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    985[0m [38;5;66;03m# POST-Training CLEAN UP[39;00m
[1;32m    986[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    987[0m log[38;5;241m.[39mdebug([38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m: trainer tearing down[39m[38;5;124m"[39m)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:1024[0m, in [0;36mTrainer._run_stage[0;34m(self)[0m
[1;32m   1022[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mtraining:
[1;32m   1023[0m     [38;5;28;01mwith[39;00m isolate_rng():
[0;32m-> 1024[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run_sanity_check[49m[43m([49m[43m)[49m
[1;32m   1025[0m     [38;5;28;01mwith[39;00m torch[38;5;241m.[39mautograd[38;5;241m.[39mset_detect_anomaly([38;5;28mself[39m[38;5;241m.[39m_detect_anomaly):
[1;32m   1026[0m         [38;5;28mself[39m[38;5;241m.[39mfit_loop[38;5;241m.[39mrun()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:1053[0m, in [0;36mTrainer._run_sanity_check[0;34m(self)[0m
[1;32m   1050[0m call[38;5;241m.[39m_call_callback_hooks([38;5;28mself[39m, [38;5;124m"[39m[38;5;124mon_sanity_check_start[39m[38;5;124m"[39m)
[1;32m   1052[0m [38;5;66;03m# run eval step[39;00m
[0;32m-> 1053[0m [43mval_loop[49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[43m)[49m
[1;32m   1055[0m call[38;5;241m.[39m_call_callback_hooks([38;5;28mself[39m, [38;5;124m"[39m[38;5;124mon_sanity_check_end[39m[38;5;124m"[39m)
[1;32m   1057[0m [38;5;66;03m# reset logger connector[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/utilities.py:179[0m, in [0;36m_no_grad_context.<locals>._decorator[0;34m(self, *args, **kwargs)[0m
[1;32m    177[0m     context_manager [38;5;241m=[39m torch[38;5;241m.[39mno_grad
[1;32m    178[0m [38;5;28;01mwith[39;00m context_manager():
[0;32m--> 179[0m     [38;5;28;01mreturn[39;00m [43mloop_run[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/evaluation_loop.py:137[0m, in [0;36m_EvaluationLoop.run[0;34m(self)[0m
[1;32m    135[0m [38;5;28;01melse[39;00m:
[1;32m    136[0m     dataloader_iter [38;5;241m=[39m [38;5;28;01mNone[39;00m
[0;32m--> 137[0m     batch, batch_idx, dataloader_idx [38;5;241m=[39m [38;5;28;43mnext[39;49m[43m([49m[43mdata_fetcher[49m[43m)[49m
[1;32m    138[0m [38;5;28;01mif[39;00m previous_dataloader_idx [38;5;241m!=[39m dataloader_idx:
[1;32m    139[0m     [38;5;66;03m# the dataloader has changed, notify the logger connector[39;00m
[1;32m    140[0m     [38;5;28mself[39m[38;5;241m.[39m_store_dataloader_outputs()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/fetchers.py:134[0m, in [0;36m_PrefetchDataFetcher.__next__[0;34m(self)[0m
[1;32m    131[0m         [38;5;28mself[39m[38;5;241m.[39mdone [38;5;241m=[39m [38;5;129;01mnot[39;00m [38;5;28mself[39m[38;5;241m.[39mbatches
[1;32m    132[0m [38;5;28;01melif[39;00m [38;5;129;01mnot[39;00m [38;5;28mself[39m[38;5;241m.[39mdone:
[1;32m    133[0m     [38;5;66;03m# this will run only when no pre-fetching was done.[39;00m
[0;32m--> 134[0m     batch [38;5;241m=[39m [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[38;5;21;43m__next__[39;49m[43m([49m[43m)[49m
[1;32m    135[0m [38;5;28;01melse[39;00m:
[1;32m    136[0m     [38;5;66;03m# the iterator is empty[39;00m
[1;32m    137[0m     [38;5;28;01mraise[39;00m [38;5;167;01mStopIteration[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/fetchers.py:61[0m, in [0;36m_DataFetcher.__next__[0;34m(self)[0m
[1;32m     59[0m [38;5;28mself[39m[38;5;241m.[39m_start_profiler()
[1;32m     60[0m [38;5;28;01mtry[39;00m:
[0;32m---> 61[0m     batch [38;5;241m=[39m [38;5;28;43mnext[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43miterator[49m[43m)[49m
[1;32m     62[0m [38;5;28;01mexcept[39;00m [38;5;167;01mStopIteration[39;00m:
[1;32m     63[0m     [38;5;28mself[39m[38;5;241m.[39mdone [38;5;241m=[39m [38;5;28;01mTrue[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/utilities/combined_loader.py:341[0m, in [0;36mCombinedLoader.__next__[0;34m(self)[0m
[1;32m    339[0m [38;5;28;01mdef[39;00m [38;5;21m__next__[39m([38;5;28mself[39m) [38;5;241m-[39m[38;5;241m>[39m _ITERATOR_RETURN:
[1;32m    340[0m     [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39m_iterator [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[0;32m--> 341[0m     out [38;5;241m=[39m [38;5;28;43mnext[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_iterator[49m[43m)[49m
[1;32m    342[0m     [38;5;28;01mif[39;00m [38;5;28misinstance[39m([38;5;28mself[39m[38;5;241m.[39m_iterator, _Sequential):
[1;32m    343[0m         [38;5;28;01mreturn[39;00m out

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/utilities/combined_loader.py:142[0m, in [0;36m_Sequential.__next__[0;34m(self)[0m
[1;32m    139[0m             [38;5;28;01mraise[39;00m [38;5;167;01mStopIteration[39;00m
[1;32m    141[0m [38;5;28;01mtry[39;00m:
[0;32m--> 142[0m     out [38;5;241m=[39m [38;5;28;43mnext[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43miterators[49m[43m[[49m[38;5;241;43m0[39;49m[43m][49m[43m)[49m
[1;32m    143[0m [38;5;28;01mexcept[39;00m [38;5;167;01mStopIteration[39;00m:
[1;32m    144[0m     [38;5;66;03m# try the next iterator[39;00m
[1;32m    145[0m     [38;5;28mself[39m[38;5;241m.[39m_use_next_iterator()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/utils/data/dataset.py:412[0m, in [0;36mSubset.__getitem__[0;34m(self, idx)[0m
[1;32m    410[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(idx, [38;5;28mlist[39m):
[1;32m    411[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39mdataset[[[38;5;28mself[39m[38;5;241m.[39mindices[i] [38;5;28;01mfor[39;00m i [38;5;129;01min[39;00m idx]]
[0;32m--> 412[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdataset[49m[43m[[49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mindices[49m[43m[[49m[43midx[49m[43m][49m[43m][49m

[0;31mTypeError[0m: 'DataLoader' object is not subscriptable

Data ready
Trainer will use only 1 of 2 GPUs because it is running inside an interactive / notebook environment. You may try to set `Trainer(devices=2)` but please note that multi-GPU inside interactive / notebook environments is considered experimental and unstable. Your mileage may vary.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name  | Type       | Params | Mode
--------------------------------------------
0 | model | Sequential | 525 K  | eval
--------------------------------------------
525 K     Trainable params
0         Non-trainable params
525 K     Total params
2.100     Total estimated model params size (MB)
0         Modules in train mode
4         Modules in eval mode

Sanity Checking: |                                                                                   | 0/? [00:00<?, ?it/s][0;31m---------------------------------------------------------------------------[0m
[0;31mTypeError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[8], line 3[0m
[1;32m      1[0m trainer [38;5;241m=[39m L[38;5;241m.[39mTrainer(limit_train_batches[38;5;241m=[39m[38;5;241m100[39m, max_epochs[38;5;241m=[39mnum_epochs, logger[38;5;241m=[39mwandb_logger, log_every_n_steps[38;5;241m=[39m[38;5;241m1[39m)
[0;32m----> 3[0m [43mtrainer[49m[38;5;241;43m.[39;49m[43mfit[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[43mtrain_loader[49m[43m,[49m[43m [49m[43mvalid_loader[49m[43m)[49m
[1;32m      6[0m model[38;5;241m.[39meval()
[1;32m      7[0m trainer[38;5;241m.[39mtest(model, dataloaders[38;5;241m=[39mtest_loader)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:539[0m, in [0;36mTrainer.fit[0;34m(self, model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)[0m
[1;32m    537[0m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstatus [38;5;241m=[39m TrainerStatus[38;5;241m.[39mRUNNING
[1;32m    538[0m [38;5;28mself[39m[38;5;241m.[39mtraining [38;5;241m=[39m [38;5;28;01mTrue[39;00m
[0;32m--> 539[0m [43mcall[49m[38;5;241;43m.[39;49m[43m_call_and_handle_interrupt[49m[43m([49m
[1;32m    540[0m [43m    [49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_fit_impl[49m[43m,[49m[43m [49m[43mmodel[49m[43m,[49m[43m [49m[43mtrain_dataloaders[49m[43m,[49m[43m [49m[43mval_dataloaders[49m[43m,[49m[43m [49m[43mdatamodule[49m[43m,[49m[43m [49m[43mckpt_path[49m
[1;32m    541[0m [43m[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/call.py:47[0m, in [0;36m_call_and_handle_interrupt[0;34m(trainer, trainer_fn, *args, **kwargs)[0m
[1;32m     45[0m     [38;5;28;01mif[39;00m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mlauncher [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m     46[0m         [38;5;28;01mreturn[39;00m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mlauncher[38;5;241m.[39mlaunch(trainer_fn, [38;5;241m*[39margs, trainer[38;5;241m=[39mtrainer, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[0;32m---> 47[0m     [38;5;28;01mreturn[39;00m [43mtrainer_fn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     49[0m [38;5;28;01mexcept[39;00m _TunerExitException:
[1;32m     50[0m     _call_teardown_hook(trainer)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:575[0m, in [0;36mTrainer._fit_impl[0;34m(self, model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)[0m
[1;32m    568[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfn [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[1;32m    569[0m ckpt_path [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_checkpoint_connector[38;5;241m.[39m_select_ckpt_path(
[1;32m    570[0m     [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfn,
[1;32m    571[0m     ckpt_path,
[1;32m    572[0m     model_provided[38;5;241m=[39m[38;5;28;01mTrue[39;00m,
[1;32m    573[0m     model_connected[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mlightning_module [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m,
[1;32m    574[0m )
[0;32m--> 575[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[43mckpt_path[49m[38;5;241;43m=[39;49m[43mckpt_path[49m[43m)[49m
[1;32m    577[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstopped
[1;32m    578[0m [38;5;28mself[39m[38;5;241m.[39mtraining [38;5;241m=[39m [38;5;28;01mFalse[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:982[0m, in [0;36mTrainer._run[0;34m(self, model, ckpt_path)[0m
[1;32m    977[0m [38;5;28mself[39m[38;5;241m.[39m_signal_connector[38;5;241m.[39mregister_signal_handlers()
[1;32m    979[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    980[0m [38;5;66;03m# RUN THE TRAINER[39;00m
[1;32m    981[0m [38;5;66;03m# ----------------------------[39;00m
[0;32m--> 982[0m results [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run_stage[49m[43m([49m[43m)[49m
[1;32m    984[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    985[0m [38;5;66;03m# POST-Training CLEAN UP[39;00m
[1;32m    986[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    987[0m log[38;5;241m.[39mdebug([38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m: trainer tearing down[39m[38;5;124m"[39m)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:1024[0m, in [0;36mTrainer._run_stage[0;34m(self)[0m
[1;32m   1022[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mtraining:
[1;32m   1023[0m     [38;5;28;01mwith[39;00m isolate_rng():
[0;32m-> 1024[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run_sanity_check[49m[43m([49m[43m)[49m
[1;32m   1025[0m     [38;5;28;01mwith[39;00m torch[38;5;241m.[39mautograd[38;5;241m.[39mset_detect_anomaly([38;5;28mself[39m[38;5;241m.[39m_detect_anomaly):
[1;32m   1026[0m         [38;5;28mself[39m[38;5;241m.[39mfit_loop[38;5;241m.[39mrun()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:1053[0m, in [0;36mTrainer._run_sanity_check[0;34m(self)[0m
[1;32m   1050[0m call[38;5;241m.[39m_call_callback_hooks([38;5;28mself[39m, [38;5;124m"[39m[38;5;124mon_sanity_check_start[39m[38;5;124m"[39m)
[1;32m   1052[0m [38;5;66;03m# run eval step[39;00m
[0;32m-> 1053[0m [43mval_loop[49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[43m)[49m
[1;32m   1055[0m call[38;5;241m.[39m_call_callback_hooks([38;5;28mself[39m, [38;5;124m"[39m[38;5;124mon_sanity_check_end[39m[38;5;124m"[39m)
[1;32m   1057[0m [38;5;66;03m# reset logger connector[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/utilities.py:179[0m, in [0;36m_no_grad_context.<locals>._decorator[0;34m(self, *args, **kwargs)[0m
[1;32m    177[0m     context_manager [38;5;241m=[39m torch[38;5;241m.[39mno_grad
[1;32m    178[0m [38;5;28;01mwith[39;00m context_manager():
[0;32m--> 179[0m     [38;5;28;01mreturn[39;00m [43mloop_run[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/evaluation_loop.py:137[0m, in [0;36m_EvaluationLoop.run[0;34m(self)[0m
[1;32m    135[0m [38;5;28;01melse[39;00m:
[1;32m    136[0m     dataloader_iter [38;5;241m=[39m [38;5;28;01mNone[39;00m
[0;32m--> 137[0m     batch, batch_idx, dataloader_idx [38;5;241m=[39m [38;5;28;43mnext[39;49m[43m([49m[43mdata_fetcher[49m[43m)[49m
[1;32m    138[0m [38;5;28;01mif[39;00m previous_dataloader_idx [38;5;241m!=[39m dataloader_idx:
[1;32m    139[0m     [38;5;66;03m# the dataloader has changed, notify the logger connector[39;00m
[1;32m    140[0m     [38;5;28mself[39m[38;5;241m.[39m_store_dataloader_outputs()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/fetchers.py:134[0m, in [0;36m_PrefetchDataFetcher.__next__[0;34m(self)[0m
[1;32m    131[0m         [38;5;28mself[39m[38;5;241m.[39mdone [38;5;241m=[39m [38;5;129;01mnot[39;00m [38;5;28mself[39m[38;5;241m.[39mbatches
[1;32m    132[0m [38;5;28;01melif[39;00m [38;5;129;01mnot[39;00m [38;5;28mself[39m[38;5;241m.[39mdone:
[1;32m    133[0m     [38;5;66;03m# this will run only when no pre-fetching was done.[39;00m
[0;32m--> 134[0m     batch [38;5;241m=[39m [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[38;5;21;43m__next__[39;49m[43m([49m[43m)[49m
[1;32m    135[0m [38;5;28;01melse[39;00m:
[1;32m    136[0m     [38;5;66;03m# the iterator is empty[39;00m
[1;32m    137[0m     [38;5;28;01mraise[39;00m [38;5;167;01mStopIteration[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/fetchers.py:61[0m, in [0;36m_DataFetcher.__next__[0;34m(self)[0m
[1;32m     59[0m [38;5;28mself[39m[38;5;241m.[39m_start_profiler()
[1;32m     60[0m [38;5;28;01mtry[39;00m:
[0;32m---> 61[0m     batch [38;5;241m=[39m [38;5;28;43mnext[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43miterator[49m[43m)[49m
[1;32m     62[0m [38;5;28;01mexcept[39;00m [38;5;167;01mStopIteration[39;00m:
[1;32m     63[0m     [38;5;28mself[39m[38;5;241m.[39mdone [38;5;241m=[39m [38;5;28;01mTrue[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/utilities/combined_loader.py:341[0m, in [0;36mCombinedLoader.__next__[0;34m(self)[0m
[1;32m    339[0m [38;5;28;01mdef[39;00m [38;5;21m__next__[39m([38;5;28mself[39m) [38;5;241m-[39m[38;5;241m>[39m _ITERATOR_RETURN:
[1;32m    340[0m     [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39m_iterator [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[0;32m--> 341[0m     out [38;5;241m=[39m [38;5;28;43mnext[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_iterator[49m[43m)[49m
[1;32m    342[0m     [38;5;28;01mif[39;00m [38;5;28misinstance[39m([38;5;28mself[39m[38;5;241m.[39m_iterator, _Sequential):
[1;32m    343[0m         [38;5;28;01mreturn[39;00m out

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/utilities/combined_loader.py:142[0m, in [0;36m_Sequential.__next__[0;34m(self)[0m
[1;32m    139[0m             [38;5;28;01mraise[39;00m [38;5;167;01mStopIteration[39;00m
[1;32m    141[0m [38;5;28;01mtry[39;00m:
[0;32m--> 142[0m     out [38;5;241m=[39m [38;5;28;43mnext[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43miterators[49m[43m[[49m[38;5;241;43m0[39;49m[43m][49m[43m)[49m
[1;32m    143[0m [38;5;28;01mexcept[39;00m [38;5;167;01mStopIteration[39;00m:
[1;32m    144[0m     [38;5;66;03m# try the next iterator[39;00m
[1;32m    145[0m     [38;5;28mself[39m[38;5;241m.[39m_use_next_iterator()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/utils/data/dataset.py:412[0m, in [0;36mSubset.__getitem__[0;34m(self, idx)[0m
[1;32m    410[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(idx, [38;5;28mlist[39m):
[1;32m    411[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39mdataset[[[38;5;28mself[39m[38;5;241m.[39mindices[i] [38;5;28;01mfor[39;00m i [38;5;129;01min[39;00m idx]]
[0;32m--> 412[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdataset[49m[43m[[49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mindices[49m[43m[[49m[43midx[49m[43m][49m[43m][49m

[0;31mTypeError[0m: 'DataLoader' object is not subscriptable

[0;31m---------------------------------------------------------------------------[0m
[0;31mNameError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[9], line 1[0m
[0;32m----> 1[0m [43mtrain_data[49m

[0;31mNameError[0m: name 'train_data' is not defined

<torch.utils.data.dataloader.DataLoader at 0x7fa6c9be8860>

<torch.utils.data.dataset.Subset at 0x7fa59a0d9730>
Trainer will use only 1 of 2 GPUs because it is running inside an interactive / notebook environment. You may try to set `Trainer(devices=2)` but please note that multi-GPU inside interactive / notebook environments is considered experimental and unstable. Your mileage may vary.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name  | Type       | Params | Mode
--------------------------------------------
0 | model | Sequential | 525 K  | eval
--------------------------------------------
525 K     Trainable params
0         Non-trainable params
525 K     Total params
2.100     Total estimated model params size (MB)
0         Modules in train mode
4         Modules in eval mode


Epoch 9: 100%|█████████████████████████████████████████████████████████████████| 79/79 [00:26<00:00,  2.93it/s, v_num=gx71]
/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:476: Your `val_dataloader`'s sampler has shuffling enabled, it is strongly recommended that you turn shuffling off for val/test dataloaders.
Testing DataLoader 0: 100%|███████████████████████████████████████████████████████████████| 25/25 [00:00<00:00, 127.24it/s]
`Trainer.fit` stopped: `max_epochs=10` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:476: Your `test_dataloader`'s sampler has shuffling enabled, it is strongly recommended that you turn shuffling off for val/test dataloaders.
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
        test/loss           2.0647506713867188
───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[{'test/loss': 2.0647506713867188}]

Imports done
Model init
Data ready
Trainer will use only 1 of 2 GPUs because it is running inside an interactive / notebook environment. You may try to set `Trainer(devices=2)` but please note that multi-GPU inside interactive / notebook environments is considered experimental and unstable. Your mileage may vary.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loggers/wandb.py:397: There is a wandb run already in progress and newly created instances of `WandbLogger` will reuse this run. If this is not desired, call `wandb.finish()` before instantiating `WandbLogger`.
/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:654: Checkpoint directory ./el-testo/khj4gx71/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name  | Type       | Params | Mode
---------------------------------------------
0 | model | Sequential | 525 K  | train
---------------------------------------------
525 K     Trainable params
0         Non-trainable params
525 K     Total params
2.100     Total estimated model params size (MB)
4         Modules in train mode
0         Modules in eval mode
Epoch 2: 100%|█████████████████████████████████████████████████████████████████| 79/79 [00:20<00:00,  3.82it/s, v_num=gx71]
                                                                                                                           
