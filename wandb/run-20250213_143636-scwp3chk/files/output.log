LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name  | Type     | Params | Mode
-------------------------------------------
0 | model | Wang2024 | 7.4 M  | train
-------------------------------------------
7.4 M     Trainable params
0         Non-trainable params
7.4 M     Total params
29.534    Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
Sanity Checking DataLoader 0:   0%|                                                                                    | 0/2 [00:00<?, ?it/s][0;31m---------------------------------------------------------------------------[0m
/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=71` in the `DataLoader` to improve performance.
[0;31mRuntimeError[0m                              Traceback (most recent call last)
File [0;32m/shared_netapp3_home/home/rogui7909/code/predict_rain_norway/rain_lighting.py:183[0m
[1;32m    177[0m model [38;5;241m=[39m LitCNN(CNN)
[1;32m    182[0m [38;5;28mprint[39m([38;5;124m'[39m[38;5;124mModel init[39m[38;5;124m'[39m)
[0;32m--> 183[0m [43mtrainer[49m[38;5;241;43m.[39;49m[43mfit[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[43mtrain_loader[49m[43m,[49m[43m [49m[43mvalid_loader[49m[43m)[49m
[1;32m    186[0m model[38;5;241m.[39meval()
[1;32m    187[0m [38;5;28;01mwith[39;00m torch[38;5;241m.[39mno_grad():

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:539[0m, in [0;36mTrainer.fit[0;34m(self, model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)[0m
[1;32m    537[0m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstatus [38;5;241m=[39m TrainerStatus[38;5;241m.[39mRUNNING
[1;32m    538[0m [38;5;28mself[39m[38;5;241m.[39mtraining [38;5;241m=[39m [38;5;28;01mTrue[39;00m
[0;32m--> 539[0m [43mcall[49m[38;5;241;43m.[39;49m[43m_call_and_handle_interrupt[49m[43m([49m
[1;32m    540[0m [43m    [49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_fit_impl[49m[43m,[49m[43m [49m[43mmodel[49m[43m,[49m[43m [49m[43mtrain_dataloaders[49m[43m,[49m[43m [49m[43mval_dataloaders[49m[43m,[49m[43m [49m[43mdatamodule[49m[43m,[49m[43m [49m[43mckpt_path[49m
[1;32m    541[0m [43m[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/call.py:47[0m, in [0;36m_call_and_handle_interrupt[0;34m(trainer, trainer_fn, *args, **kwargs)[0m
[1;32m     45[0m     [38;5;28;01mif[39;00m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mlauncher [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m     46[0m         [38;5;28;01mreturn[39;00m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mlauncher[38;5;241m.[39mlaunch(trainer_fn, [38;5;241m*[39margs, trainer[38;5;241m=[39mtrainer, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[0;32m---> 47[0m     [38;5;28;01mreturn[39;00m [43mtrainer_fn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     49[0m [38;5;28;01mexcept[39;00m _TunerExitException:
[1;32m     50[0m     _call_teardown_hook(trainer)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:575[0m, in [0;36mTrainer._fit_impl[0;34m(self, model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)[0m
[1;32m    568[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfn [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[1;32m    569[0m ckpt_path [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_checkpoint_connector[38;5;241m.[39m_select_ckpt_path(
[1;32m    570[0m     [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfn,
[1;32m    571[0m     ckpt_path,
[1;32m    572[0m     model_provided[38;5;241m=[39m[38;5;28;01mTrue[39;00m,
[1;32m    573[0m     model_connected[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mlightning_module [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m,
[1;32m    574[0m )
[0;32m--> 575[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[43mckpt_path[49m[38;5;241;43m=[39;49m[43mckpt_path[49m[43m)[49m
[1;32m    577[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstopped
[1;32m    578[0m [38;5;28mself[39m[38;5;241m.[39mtraining [38;5;241m=[39m [38;5;28;01mFalse[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:982[0m, in [0;36mTrainer._run[0;34m(self, model, ckpt_path)[0m
[1;32m    977[0m [38;5;28mself[39m[38;5;241m.[39m_signal_connector[38;5;241m.[39mregister_signal_handlers()
[1;32m    979[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    980[0m [38;5;66;03m# RUN THE TRAINER[39;00m
[1;32m    981[0m [38;5;66;03m# ----------------------------[39;00m
[0;32m--> 982[0m results [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run_stage[49m[43m([49m[43m)[49m
[1;32m    984[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    985[0m [38;5;66;03m# POST-Training CLEAN UP[39;00m
[1;32m    986[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    987[0m log[38;5;241m.[39mdebug([38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m: trainer tearing down[39m[38;5;124m"[39m)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:1024[0m, in [0;36mTrainer._run_stage[0;34m(self)[0m
[1;32m   1022[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mtraining:
[1;32m   1023[0m     [38;5;28;01mwith[39;00m isolate_rng():
[0;32m-> 1024[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run_sanity_check[49m[43m([49m[43m)[49m
[1;32m   1025[0m     [38;5;28;01mwith[39;00m torch[38;5;241m.[39mautograd[38;5;241m.[39mset_detect_anomaly([38;5;28mself[39m[38;5;241m.[39m_detect_anomaly):
[1;32m   1026[0m         [38;5;28mself[39m[38;5;241m.[39mfit_loop[38;5;241m.[39mrun()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:1053[0m, in [0;36mTrainer._run_sanity_check[0;34m(self)[0m
[1;32m   1050[0m call[38;5;241m.[39m_call_callback_hooks([38;5;28mself[39m, [38;5;124m"[39m[38;5;124mon_sanity_check_start[39m[38;5;124m"[39m)
[1;32m   1052[0m [38;5;66;03m# run eval step[39;00m
[0;32m-> 1053[0m [43mval_loop[49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[43m)[49m
[1;32m   1055[0m call[38;5;241m.[39m_call_callback_hooks([38;5;28mself[39m, [38;5;124m"[39m[38;5;124mon_sanity_check_end[39m[38;5;124m"[39m)
[1;32m   1057[0m [38;5;66;03m# reset logger connector[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/utilities.py:179[0m, in [0;36m_no_grad_context.<locals>._decorator[0;34m(self, *args, **kwargs)[0m
[1;32m    177[0m     context_manager [38;5;241m=[39m torch[38;5;241m.[39mno_grad
[1;32m    178[0m [38;5;28;01mwith[39;00m context_manager():
[0;32m--> 179[0m     [38;5;28;01mreturn[39;00m [43mloop_run[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/evaluation_loop.py:144[0m, in [0;36m_EvaluationLoop.run[0;34m(self)[0m
[1;32m    142[0m     [38;5;28mself[39m[38;5;241m.[39mbatch_progress[38;5;241m.[39mis_last_batch [38;5;241m=[39m data_fetcher[38;5;241m.[39mdone
[1;32m    143[0m     [38;5;66;03m# run step hooks[39;00m
[0;32m--> 144[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_evaluation_step[49m[43m([49m[43mbatch[49m[43m,[49m[43m [49m[43mbatch_idx[49m[43m,[49m[43m [49m[43mdataloader_idx[49m[43m,[49m[43m [49m[43mdataloader_iter[49m[43m)[49m
[1;32m    145[0m [38;5;28;01mexcept[39;00m [38;5;167;01mStopIteration[39;00m:
[1;32m    146[0m     [38;5;66;03m# this needs to wrap the `*_step` call too (not just `next`) for `dataloader_iter` support[39;00m
[1;32m    147[0m     [38;5;28;01mbreak[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/evaluation_loop.py:433[0m, in [0;36m_EvaluationLoop._evaluation_step[0;34m(self, batch, batch_idx, dataloader_idx, dataloader_iter)[0m
[1;32m    427[0m hook_name [38;5;241m=[39m [38;5;124m"[39m[38;5;124mtest_step[39m[38;5;124m"[39m [38;5;28;01mif[39;00m trainer[38;5;241m.[39mtesting [38;5;28;01melse[39;00m [38;5;124m"[39m[38;5;124mvalidation_step[39m[38;5;124m"[39m
[1;32m    428[0m step_args [38;5;241m=[39m (
[1;32m    429[0m     [38;5;28mself[39m[38;5;241m.[39m_build_step_args_from_hook_kwargs(hook_kwargs, hook_name)
[1;32m    430[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m using_dataloader_iter
[1;32m    431[0m     [38;5;28;01melse[39;00m (dataloader_iter,)
[1;32m    432[0m )
[0;32m--> 433[0m output [38;5;241m=[39m [43mcall[49m[38;5;241;43m.[39;49m[43m_call_strategy_hook[49m[43m([49m[43mtrainer[49m[43m,[49m[43m [49m[43mhook_name[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43mstep_args[49m[43m)[49m
[1;32m    435[0m [38;5;28mself[39m[38;5;241m.[39mbatch_progress[38;5;241m.[39mincrement_processed()
[1;32m    437[0m [38;5;28;01mif[39;00m using_dataloader_iter:
[1;32m    438[0m     [38;5;66;03m# update the hook kwargs now that the step method might have consumed the iterator[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/call.py:323[0m, in [0;36m_call_strategy_hook[0;34m(trainer, hook_name, *args, **kwargs)[0m
[1;32m    320[0m     [38;5;28;01mreturn[39;00m [38;5;28;01mNone[39;00m
[1;32m    322[0m [38;5;28;01mwith[39;00m trainer[38;5;241m.[39mprofiler[38;5;241m.[39mprofile([38;5;124mf[39m[38;5;124m"[39m[38;5;124m[Strategy][39m[38;5;132;01m{[39;00mtrainer[38;5;241m.[39mstrategy[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m.[39m[38;5;132;01m{[39;00mhook_name[38;5;132;01m}[39;00m[38;5;124m"[39m):
[0;32m--> 323[0m     output [38;5;241m=[39m [43mfn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    325[0m [38;5;66;03m# restore current_fx when nested context[39;00m
[1;32m    326[0m pl_module[38;5;241m.[39m_current_fx_name [38;5;241m=[39m prev_fx_name

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/strategies/strategy.py:412[0m, in [0;36mStrategy.validation_step[0;34m(self, *args, **kwargs)[0m
[1;32m    410[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mmodel [38;5;241m!=[39m [38;5;28mself[39m[38;5;241m.[39mlightning_module:
[1;32m    411[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_redirection([38;5;28mself[39m[38;5;241m.[39mmodel, [38;5;28mself[39m[38;5;241m.[39mlightning_module, [38;5;124m"[39m[38;5;124mvalidation_step[39m[38;5;124m"[39m, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[0;32m--> 412[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mlightning_module[49m[38;5;241;43m.[39;49m[43mvalidation_step[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/shared_netapp3_home/home/rogui7909/code/predict_rain_norway/rain_lighting.py:159[0m, in [0;36mLitCNN.validation_step[0;34m(self, batch, batch_idx)[0m
[1;32m    157[0m [38;5;66;03m# x = x.view(x.size(0), -1)[39;00m
[1;32m    158[0m pred [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mmodel(x)
[0;32m--> 159[0m loss [38;5;241m=[39m [43mnn[49m[38;5;241;43m.[39;49m[43mCrossEntropyLoss[49m[43m([49m[43m)[49m[43m([49m[43mpred[49m[43m,[49m[43m [49m[43my[49m[43m)[49m
[1;32m    160[0m [38;5;28mself[39m[38;5;241m.[39mlog([38;5;124m"[39m[38;5;124mval/loss[39m[38;5;124m"[39m, loss)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1736[0m, in [0;36mModule._wrapped_call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1734[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_compiled_call_impl([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)  [38;5;66;03m# type: ignore[misc][39;00m
[1;32m   1735[0m [38;5;28;01melse[39;00m:
[0;32m-> 1736[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_call_impl[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1747[0m, in [0;36mModule._call_impl[0;34m(self, *args, **kwargs)[0m
[1;32m   1742[0m [38;5;66;03m# If we don't have any hooks, we want to skip the rest of the logic in[39;00m
[1;32m   1743[0m [38;5;66;03m# this function, and just call forward.[39;00m
[1;32m   1744[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m ([38;5;28mself[39m[38;5;241m.[39m_backward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_backward_pre_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_hooks [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_pre_hooks
[1;32m   1745[0m         [38;5;129;01mor[39;00m _global_backward_pre_hooks [38;5;129;01mor[39;00m _global_backward_hooks
[1;32m   1746[0m         [38;5;129;01mor[39;00m _global_forward_hooks [38;5;129;01mor[39;00m _global_forward_pre_hooks):
[0;32m-> 1747[0m     [38;5;28;01mreturn[39;00m [43mforward_call[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m   1749[0m result [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m   1750[0m called_always_called_hooks [38;5;241m=[39m [38;5;28mset[39m()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/loss.py:1293[0m, in [0;36mCrossEntropyLoss.forward[0;34m(self, input, target)[0m
[1;32m   1292[0m [38;5;28;01mdef[39;00m [38;5;21mforward[39m([38;5;28mself[39m, [38;5;28minput[39m: Tensor, target: Tensor) [38;5;241m-[39m[38;5;241m>[39m Tensor:
[0;32m-> 1293[0m     [38;5;28;01mreturn[39;00m [43mF[49m[38;5;241;43m.[39;49m[43mcross_entropy[49m[43m([49m
[1;32m   1294[0m [43m        [49m[38;5;28;43minput[39;49m[43m,[49m
[1;32m   1295[0m [43m        [49m[43mtarget[49m[43m,[49m
[1;32m   1296[0m [43m        [49m[43mweight[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mweight[49m[43m,[49m
[1;32m   1297[0m [43m        [49m[43mignore_index[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mignore_index[49m[43m,[49m
[1;32m   1298[0m [43m        [49m[43mreduction[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mreduction[49m[43m,[49m
[1;32m   1299[0m [43m        [49m[43mlabel_smoothing[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mlabel_smoothing[49m[43m,[49m
[1;32m   1300[0m [43m    [49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/functional.py:3479[0m, in [0;36mcross_entropy[0;34m(input, target, weight, size_average, ignore_index, reduce, reduction, label_smoothing)[0m
[1;32m   3477[0m [38;5;28;01mif[39;00m size_average [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mor[39;00m reduce [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m   3478[0m     reduction [38;5;241m=[39m _Reduction[38;5;241m.[39mlegacy_get_string(size_average, reduce)
[0;32m-> 3479[0m [38;5;28;01mreturn[39;00m [43mtorch[49m[38;5;241;43m.[39;49m[43m_C[49m[38;5;241;43m.[39;49m[43m_nn[49m[38;5;241;43m.[39;49m[43mcross_entropy_loss[49m[43m([49m
[1;32m   3480[0m [43m    [49m[38;5;28;43minput[39;49m[43m,[49m
[1;32m   3481[0m [43m    [49m[43mtarget[49m[43m,[49m
[1;32m   3482[0m [43m    [49m[43mweight[49m[43m,[49m
[1;32m   3483[0m [43m    [49m[43m_Reduction[49m[38;5;241;43m.[39;49m[43mget_enum[49m[43m([49m[43mreduction[49m[43m)[49m[43m,[49m
[1;32m   3484[0m [43m    [49m[43mignore_index[49m[43m,[49m
[1;32m   3485[0m [43m    [49m[43mlabel_smoothing[49m[43m,[49m
[1;32m   3486[0m [43m[49m[43m)[49m

[0;31mRuntimeError[0m: "nll_loss_forward_reduce_cuda_kernel_2d_index" not implemented for 'Float'

tensor([ 1.7750,  3.1762,  1.8375,  ...,  0.6954, 20.0781, 16.7039])

Data ready
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
Model init
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name  | Type     | Params | Mode
-------------------------------------------
0 | model | Wang2024 | 7.4 M  | train
-------------------------------------------
7.4 M     Trainable params
0         Non-trainable params
7.4 M     Total params
29.534    Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
Epoch 0:   0%|                                                                                                       | 0/100 [00:00<?, ?it/s][0;31m---------------------------------------------------------------------------[0m
/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=71` in the `DataLoader` to improve performance.
/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=71` in the `DataLoader` to improve performance.
[0;31mRuntimeError[0m                              Traceback (most recent call last)
File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/call.py:47[0m, in [0;36m_call_and_handle_interrupt[0;34m(trainer, trainer_fn, *args, **kwargs)[0m
[1;32m     46[0m         [38;5;28;01mreturn[39;00m trainer[38;5;241m.[39mstrategy[38;5;241m.[39mlauncher[38;5;241m.[39mlaunch(trainer_fn, [38;5;241m*[39margs, trainer[38;5;241m=[39mtrainer, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[0;32m---> 47[0m     [38;5;28;01mreturn[39;00m [43mtrainer_fn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     49[0m [38;5;28;01mexcept[39;00m _TunerExitException:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:575[0m, in [0;36mTrainer._fit_impl[0;34m(self, model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)[0m
[1;32m    569[0m ckpt_path [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_checkpoint_connector[38;5;241m.[39m_select_ckpt_path(
[1;32m    570[0m     [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mfn,
[1;32m    571[0m     ckpt_path,
[1;32m    572[0m     model_provided[38;5;241m=[39m[38;5;28;01mTrue[39;00m,
[1;32m    573[0m     model_connected[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mlightning_module [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m,
[1;32m    574[0m )
[0;32m--> 575[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[43mckpt_path[49m[38;5;241;43m=[39;49m[43mckpt_path[49m[43m)[49m
[1;32m    577[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstopped

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:982[0m, in [0;36mTrainer._run[0;34m(self, model, ckpt_path)[0m
[1;32m    979[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    980[0m [38;5;66;03m# RUN THE TRAINER[39;00m
[1;32m    981[0m [38;5;66;03m# ----------------------------[39;00m
[0;32m--> 982[0m results [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_run_stage[49m[43m([49m[43m)[49m
[1;32m    984[0m [38;5;66;03m# ----------------------------[39;00m
[1;32m    985[0m [38;5;66;03m# POST-Training CLEAN UP[39;00m
[1;32m    986[0m [38;5;66;03m# ----------------------------[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:1026[0m, in [0;36mTrainer._run_stage[0;34m(self)[0m
[1;32m   1025[0m [38;5;28;01mwith[39;00m torch[38;5;241m.[39mautograd[38;5;241m.[39mset_detect_anomaly([38;5;28mself[39m[38;5;241m.[39m_detect_anomaly):
[0;32m-> 1026[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mfit_loop[49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[43m)[49m
[1;32m   1027[0m [38;5;28;01mreturn[39;00m [38;5;28;01mNone[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/fit_loop.py:216[0m, in [0;36m_FitLoop.run[0;34m(self)[0m
[1;32m    215[0m [38;5;28mself[39m[38;5;241m.[39mon_advance_start()
[0;32m--> 216[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43madvance[49m[43m([49m[43m)[49m
[1;32m    217[0m [38;5;28mself[39m[38;5;241m.[39mon_advance_end()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/fit_loop.py:455[0m, in [0;36m_FitLoop.advance[0;34m(self)[0m
[1;32m    454[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39m_data_fetcher [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[0;32m--> 455[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mepoch_loop[49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_data_fetcher[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/training_epoch_loop.py:150[0m, in [0;36m_TrainingEpochLoop.run[0;34m(self, data_fetcher)[0m
[1;32m    149[0m [38;5;28;01mtry[39;00m:
[0;32m--> 150[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43madvance[49m[43m([49m[43mdata_fetcher[49m[43m)[49m
[1;32m    151[0m     [38;5;28mself[39m[38;5;241m.[39mon_advance_end(data_fetcher)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/training_epoch_loop.py:320[0m, in [0;36m_TrainingEpochLoop.advance[0;34m(self, data_fetcher)[0m
[1;32m    318[0m [38;5;28;01mif[39;00m trainer[38;5;241m.[39mlightning_module[38;5;241m.[39mautomatic_optimization:
[1;32m    319[0m     [38;5;66;03m# in automatic optimization, there can only be one optimizer[39;00m
[0;32m--> 320[0m     batch_output [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mautomatic_optimization[49m[38;5;241;43m.[39;49m[43mrun[49m[43m([49m[43mtrainer[49m[38;5;241;43m.[39;49m[43moptimizers[49m[43m[[49m[38;5;241;43m0[39;49m[43m][49m[43m,[49m[43m [49m[43mbatch_idx[49m[43m,[49m[43m [49m[43mkwargs[49m[43m)[49m
[1;32m    321[0m [38;5;28;01melse[39;00m:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/optimization/automatic.py:192[0m, in [0;36m_AutomaticOptimization.run[0;34m(self, optimizer, batch_idx, kwargs)[0m
[1;32m    187[0m [38;5;66;03m# ------------------------------[39;00m
[1;32m    188[0m [38;5;66;03m# BACKWARD PASS[39;00m
[1;32m    189[0m [38;5;66;03m# ------------------------------[39;00m
[1;32m    190[0m [38;5;66;03m# gradient update with accumulated gradients[39;00m
[1;32m    191[0m [38;5;28;01melse[39;00m:
[0;32m--> 192[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_optimizer_step[49m[43m([49m[43mbatch_idx[49m[43m,[49m[43m [49m[43mclosure[49m[43m)[49m
[1;32m    194[0m result [38;5;241m=[39m closure[38;5;241m.[39mconsume_result()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/optimization/automatic.py:270[0m, in [0;36m_AutomaticOptimization._optimizer_step[0;34m(self, batch_idx, train_step_and_backward_closure)[0m
[1;32m    269[0m [38;5;66;03m# model hook[39;00m
[0;32m--> 270[0m [43mcall[49m[38;5;241;43m.[39;49m[43m_call_lightning_module_hook[49m[43m([49m
[1;32m    271[0m [43m    [49m[43mtrainer[49m[43m,[49m
[1;32m    272[0m [43m    [49m[38;5;124;43m"[39;49m[38;5;124;43moptimizer_step[39;49m[38;5;124;43m"[39;49m[43m,[49m
[1;32m    273[0m [43m    [49m[43mtrainer[49m[38;5;241;43m.[39;49m[43mcurrent_epoch[49m[43m,[49m
[1;32m    274[0m [43m    [49m[43mbatch_idx[49m[43m,[49m
[1;32m    275[0m [43m    [49m[43moptimizer[49m[43m,[49m
[1;32m    276[0m [43m    [49m[43mtrain_step_and_backward_closure[49m[43m,[49m
[1;32m    277[0m [43m[49m[43m)[49m
[1;32m    279[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m should_accumulate:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/call.py:171[0m, in [0;36m_call_lightning_module_hook[0;34m(trainer, hook_name, pl_module, *args, **kwargs)[0m
[1;32m    170[0m [38;5;28;01mwith[39;00m trainer[38;5;241m.[39mprofiler[38;5;241m.[39mprofile([38;5;124mf[39m[38;5;124m"[39m[38;5;124m[LightningModule][39m[38;5;132;01m{[39;00mpl_module[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m.[39m[38;5;132;01m{[39;00mhook_name[38;5;132;01m}[39;00m[38;5;124m"[39m):
[0;32m--> 171[0m     output [38;5;241m=[39m [43mfn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    173[0m [38;5;66;03m# restore current_fx when nested context[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/module.py:1302[0m, in [0;36mLightningModule.optimizer_step[0;34m(self, epoch, batch_idx, optimizer, optimizer_closure)[0m
[1;32m   1278[0m [38;5;250m[39m[38;5;124mr[39m[38;5;124;03m"""Override this method to adjust the default way the :class:`~lightning.pytorch.trainer.trainer.Trainer` calls[39;00m
[1;32m   1279[0m [38;5;124;03mthe optimizer.[39;00m
[1;32m   1280[0m
[0;32m   (...)[0m
[1;32m   1300[0m
[1;32m   1301[0m [38;5;124;03m"""[39;00m
[0;32m-> 1302[0m [43moptimizer[49m[38;5;241;43m.[39;49m[43mstep[49m[43m([49m[43mclosure[49m[38;5;241;43m=[39;49m[43moptimizer_closure[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/optimizer.py:154[0m, in [0;36mLightningOptimizer.step[0;34m(self, closure, **kwargs)[0m
[1;32m    153[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39m_strategy [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[0;32m--> 154[0m step_output [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_strategy[49m[38;5;241;43m.[39;49m[43moptimizer_step[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_optimizer[49m[43m,[49m[43m [49m[43mclosure[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    156[0m [38;5;28mself[39m[38;5;241m.[39m_on_after_step()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/strategies/strategy.py:239[0m, in [0;36mStrategy.optimizer_step[0;34m(self, optimizer, closure, model, **kwargs)[0m
[1;32m    238[0m [38;5;28;01massert[39;00m [38;5;28misinstance[39m(model, pl[38;5;241m.[39mLightningModule)
[0;32m--> 239[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mprecision_plugin[49m[38;5;241;43m.[39;49m[43moptimizer_step[49m[43m([49m[43moptimizer[49m[43m,[49m[43m [49m[43mmodel[49m[38;5;241;43m=[39;49m[43mmodel[49m[43m,[49m[43m [49m[43mclosure[49m[38;5;241;43m=[39;49m[43mclosure[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/plugins/precision/precision.py:123[0m, in [0;36mPrecision.optimizer_step[0;34m(self, optimizer, model, closure, **kwargs)[0m
[1;32m    122[0m closure [38;5;241m=[39m partial([38;5;28mself[39m[38;5;241m.[39m_wrap_closure, model, optimizer, closure)
[0;32m--> 123[0m [38;5;28;01mreturn[39;00m [43moptimizer[49m[38;5;241;43m.[39;49m[43mstep[49m[43m([49m[43mclosure[49m[38;5;241;43m=[39;49m[43mclosure[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/optim/optimizer.py:487[0m, in [0;36mOptimizer.profile_hook_step.<locals>.wrapper[0;34m(*args, **kwargs)[0m
[1;32m    483[0m             [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m(
[1;32m    484[0m                 [38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00mfunc[38;5;132;01m}[39;00m[38;5;124m must return None or a tuple of (new_args, new_kwargs), but got [39m[38;5;132;01m{[39;00mresult[38;5;132;01m}[39;00m[38;5;124m.[39m[38;5;124m"[39m
[1;32m    485[0m             )
[0;32m--> 487[0m out [38;5;241m=[39m [43mfunc[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    488[0m [38;5;28mself[39m[38;5;241m.[39m_optimizer_step_code()

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/optim/optimizer.py:91[0m, in [0;36m_use_grad_for_differentiable.<locals>._use_grad[0;34m(self, *args, **kwargs)[0m
[1;32m     90[0m     torch[38;5;241m.[39m_dynamo[38;5;241m.[39mgraph_break()
[0;32m---> 91[0m     ret [38;5;241m=[39m [43mfunc[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     92[0m [38;5;28;01mfinally[39;00m:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/optim/adam.py:202[0m, in [0;36mAdam.step[0;34m(self, closure)[0m
[1;32m    201[0m     [38;5;28;01mwith[39;00m torch[38;5;241m.[39menable_grad():
[0;32m--> 202[0m         loss [38;5;241m=[39m [43mclosure[49m[43m([49m[43m)[49m
[1;32m    204[0m [38;5;28;01mfor[39;00m group [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39mparam_groups:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/plugins/precision/precision.py:109[0m, in [0;36mPrecision._wrap_closure[0;34m(self, model, optimizer, closure)[0m
[1;32m    102[0m [38;5;250m[39m[38;5;124;03m"""This double-closure allows makes sure the ``closure`` is executed before the ``on_before_optimizer_step``[39;00m
[1;32m    103[0m [38;5;124;03mhook is called.[39;00m
[1;32m    104[0m
[0;32m   (...)[0m
[1;32m    107[0m
[1;32m    108[0m [38;5;124;03m"""[39;00m
[0;32m--> 109[0m closure_result [38;5;241m=[39m [43mclosure[49m[43m([49m[43m)[49m
[1;32m    110[0m [38;5;28mself[39m[38;5;241m.[39m_after_closure(model, optimizer)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/optimization/automatic.py:146[0m, in [0;36mClosure.__call__[0;34m(self, *args, **kwargs)[0m
[1;32m    144[0m [38;5;129m@override[39m
[1;32m    145[0m [38;5;28;01mdef[39;00m [38;5;21m__call__[39m([38;5;28mself[39m, [38;5;241m*[39margs: Any, [38;5;241m*[39m[38;5;241m*[39mkwargs: Any) [38;5;241m-[39m[38;5;241m>[39m Optional[Tensor]:
[0;32m--> 146[0m     [38;5;28mself[39m[38;5;241m.[39m_result [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mclosure[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    147[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_result[38;5;241m.[39mloss

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/utils/_contextlib.py:116[0m, in [0;36mcontext_decorator.<locals>.decorate_context[0;34m(*args, **kwargs)[0m
[1;32m    115[0m [38;5;28;01mwith[39;00m ctx_factory():
[0;32m--> 116[0m     [38;5;28;01mreturn[39;00m [43mfunc[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/optimization/automatic.py:131[0m, in [0;36mClosure.closure[0;34m(self, *args, **kwargs)[0m
[1;32m    128[0m [38;5;129m@override[39m
[1;32m    129[0m [38;5;129m@torch[39m[38;5;241m.[39menable_grad()
[1;32m    130[0m [38;5;28;01mdef[39;00m [38;5;21mclosure[39m([38;5;28mself[39m, [38;5;241m*[39margs: Any, [38;5;241m*[39m[38;5;241m*[39mkwargs: Any) [38;5;241m-[39m[38;5;241m>[39m ClosureResult:
[0;32m--> 131[0m     step_output [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_step_fn[49m[43m([49m[43m)[49m
[1;32m    133[0m     [38;5;28;01mif[39;00m step_output[38;5;241m.[39mclosure_loss [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/loops/optimization/automatic.py:319[0m, in [0;36m_AutomaticOptimization._training_step[0;34m(self, kwargs)[0m
[1;32m    317[0m trainer [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mtrainer
[0;32m--> 319[0m training_step_output [38;5;241m=[39m [43mcall[49m[38;5;241;43m.[39;49m[43m_call_strategy_hook[49m[43m([49m[43mtrainer[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mtraining_step[39;49m[38;5;124;43m"[39;49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43mkwargs[49m[38;5;241;43m.[39;49m[43mvalues[49m[43m([49m[43m)[49m[43m)[49m
[1;32m    320[0m [38;5;28mself[39m[38;5;241m.[39mtrainer[38;5;241m.[39mstrategy[38;5;241m.[39mpost_training_step()  [38;5;66;03m# unused hook - call anyway for backward compatibility[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/call.py:323[0m, in [0;36m_call_strategy_hook[0;34m(trainer, hook_name, *args, **kwargs)[0m
[1;32m    322[0m [38;5;28;01mwith[39;00m trainer[38;5;241m.[39mprofiler[38;5;241m.[39mprofile([38;5;124mf[39m[38;5;124m"[39m[38;5;124m[Strategy][39m[38;5;132;01m{[39;00mtrainer[38;5;241m.[39mstrategy[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m.[39m[38;5;132;01m{[39;00mhook_name[38;5;132;01m}[39;00m[38;5;124m"[39m):
[0;32m--> 323[0m     output [38;5;241m=[39m [43mfn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    325[0m [38;5;66;03m# restore current_fx when nested context[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/strategies/strategy.py:391[0m, in [0;36mStrategy.training_step[0;34m(self, *args, **kwargs)[0m
[1;32m    390[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_forward_redirection([38;5;28mself[39m[38;5;241m.[39mmodel, [38;5;28mself[39m[38;5;241m.[39mlightning_module, [38;5;124m"[39m[38;5;124mtraining_step[39m[38;5;124m"[39m, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[0;32m--> 391[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mlightning_module[49m[38;5;241;43m.[39;49m[43mtraining_step[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

Cell [0;32mIn[5], line 49[0m, in [0;36mLitCNN.training_step[0;34m(self, batch, batch_idx)[0m
[1;32m     48[0m loss [38;5;241m=[39m nn[38;5;241m.[39mCrossEntropyLoss()(pred, y)
[0;32m---> 49[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mlog[49m[43m([49m[38;5;124;43m"[39;49m[38;5;124;43mtrain/loss[39;49m[38;5;124;43m"[39;49m[43m,[49m[43m [49m[43mloss[49m[43m)[49m
[1;32m     50[0m [38;5;28;01mreturn[39;00m loss

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/core/module.py:521[0m, in [0;36mLightningModule.log[0;34m(self, name, value, prog_bar, logger, on_step, on_epoch, reduce_fx, enable_graph, sync_dist, sync_dist_group, add_dataloader_idx, batch_size, metric_attribute, rank_zero_only)[0m
[1;32m    519[0m     logger [38;5;241m=[39m [38;5;28;01mTrue[39;00m
[0;32m--> 521[0m [43mresults[49m[38;5;241;43m.[39;49m[43mlog[49m[43m([49m
[1;32m    522[0m [43m    [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_current_fx_name[49m[43m,[49m
[1;32m    523[0m [43m    [49m[43mname[49m[43m,[49m
[1;32m    524[0m [43m    [49m[43mvalue[49m[43m,[49m
[1;32m    525[0m [43m    [49m[43mprog_bar[49m[38;5;241;43m=[39;49m[43mprog_bar[49m[43m,[49m
[1;32m    526[0m [43m    [49m[43mlogger[49m[38;5;241;43m=[39;49m[43mlogger[49m[43m,[49m
[1;32m    527[0m [43m    [49m[43mon_step[49m[38;5;241;43m=[39;49m[43mon_step[49m[43m,[49m
[1;32m    528[0m [43m    [49m[43mon_epoch[49m[38;5;241;43m=[39;49m[43mon_epoch[49m[43m,[49m
[1;32m    529[0m [43m    [49m[43mreduce_fx[49m[38;5;241;43m=[39;49m[43mreduce_fx[49m[43m,[49m
[1;32m    530[0m [43m    [49m[43menable_graph[49m[38;5;241;43m=[39;49m[43menable_graph[49m[43m,[49m
[1;32m    531[0m [43m    [49m[43madd_dataloader_idx[49m[38;5;241;43m=[39;49m[43madd_dataloader_idx[49m[43m,[49m
[1;32m    532[0m [43m    [49m[43mbatch_size[49m[38;5;241;43m=[39;49m[43mbatch_size[49m[43m,[49m
[1;32m    533[0m [43m    [49m[43msync_dist[49m[38;5;241;43m=[39;49m[43msync_dist[49m[43m [49m[38;5;129;43;01mand[39;49;00m[43m [49m[43mtrainer[49m[38;5;241;43m.[39;49m[43m_accelerator_connector[49m[38;5;241;43m.[39;49m[43mis_distributed[49m[43m,[49m
[1;32m    534[0m [43m    [49m[43msync_dist_fn[49m[38;5;241;43m=[39;49m[43mtrainer[49m[38;5;241;43m.[39;49m[43mstrategy[49m[38;5;241;43m.[39;49m[43mreduce[49m[43m,[49m
[1;32m    535[0m [43m    [49m[43msync_dist_group[49m[38;5;241;43m=[39;49m[43msync_dist_group[49m[43m,[49m
[1;32m    536[0m [43m    [49m[43mmetric_attribute[49m[38;5;241;43m=[39;49m[43mmetric_attribute[49m[43m,[49m
[1;32m    537[0m [43m    [49m[43mrank_zero_only[49m[38;5;241;43m=[39;49m[43mrank_zero_only[49m[43m,[49m
[1;32m    538[0m [43m[49m[43m)[49m
[1;32m    540[0m trainer[38;5;241m.[39m_logger_connector[38;5;241m.[39m_current_fx [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_current_fx_name

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py:632[0m, in [0;36mDisableContext.__call__.<locals>._fn[0;34m(*args, **kwargs)[0m
[1;32m    631[0m [38;5;28;01mtry[39;00m:
[0;32m--> 632[0m     [38;5;28;01mreturn[39;00m [43mfn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    633[0m [38;5;28;01mfinally[39;00m:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py:413[0m, in [0;36m_ResultCollection.log[0;34m(self, fx, name, value, prog_bar, logger, on_step, on_epoch, reduce_fx, enable_graph, sync_dist, sync_dist_fn, sync_dist_group, add_dataloader_idx, batch_size, metric_attribute, rank_zero_only)[0m
[1;32m    410[0m     [38;5;28;01mraise[39;00m MisconfigurationException(
[1;32m    411[0m         [38;5;124mf[39m[38;5;124m"[39m[38;5;124mYou called `self.log([39m[38;5;132;01m{[39;00mname[38;5;132;01m}[39;00m[38;5;124m, ...)` twice in `[39m[38;5;132;01m{[39;00mfx[38;5;132;01m}[39;00m[38;5;124m` with different arguments. This is not allowed[39m[38;5;124m"[39m
[1;32m    412[0m     )
[0;32m--> 413[0m [38;5;28;43mself[39;49m[43m[[49m[43mkey[49m[43m][49m[38;5;241;43m.[39;49m[43mto[49m[43m([49m[43mvalue[49m[38;5;241;43m.[39;49m[43mdevice[49m[43m)[49m
[1;32m    415[0m batch_size [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_extract_batch_size([38;5;28mself[39m[key], batch_size, meta)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py:309[0m, in [0;36m_ResultMetric.to[0;34m(self, *args, **kwargs)[0m
[1;32m    308[0m d [38;5;241m=[39m [38;5;28mdict[39m([38;5;28mself[39m[38;5;241m.[39m[38;5;18m__dict__[39m)
[0;32m--> 309[0m [38;5;28mself[39m[38;5;241m.[39m[38;5;18m__dict__[39m[38;5;241m.[39mupdate([43mapply_to_collection[49m[43m([49m[43md[49m[43m,[49m[43m [49m[43m([49m[43mTensor[49m[43m,[49m[43m [49m[43mMetric[49m[43m)[49m[43m,[49m[43m [49m[43mmove_data_to_device[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m)
[1;32m    310[0m [38;5;28;01mreturn[39;00m [38;5;28mself[39m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning_utilities/core/apply_func.py:73[0m, in [0;36mapply_to_collection[0;34m(data, dtype, function, wrong_dtype, include_none, allow_frozen, *args, **kwargs)[0m
[1;32m     72[0m [38;5;66;03m# slow path for everything else[39;00m
[0;32m---> 73[0m [38;5;28;01mreturn[39;00m [43m_apply_to_collection_slow[49m[43m([49m
[1;32m     74[0m [43m    [49m[43mdata[49m[43m,[49m
[1;32m     75[0m [43m    [49m[43mdtype[49m[43m,[49m
[1;32m     76[0m [43m    [49m[43mfunction[49m[43m,[49m
[1;32m     77[0m [43m    [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m
[1;32m     78[0m [43m    [49m[43mwrong_dtype[49m[38;5;241;43m=[39;49m[43mwrong_dtype[49m[43m,[49m
[1;32m     79[0m [43m    [49m[43minclude_none[49m[38;5;241;43m=[39;49m[43minclude_none[49m[43m,[49m
[1;32m     80[0m [43m    [49m[43mallow_frozen[49m[38;5;241;43m=[39;49m[43mallow_frozen[49m[43m,[49m
[1;32m     81[0m [43m    [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
[1;32m     82[0m [43m[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning_utilities/core/apply_func.py:105[0m, in [0;36m_apply_to_collection_slow[0;34m(data, dtype, function, wrong_dtype, include_none, allow_frozen, *args, **kwargs)[0m
[1;32m    104[0m [38;5;28;01mfor[39;00m k, v [38;5;129;01min[39;00m data[38;5;241m.[39mitems():
[0;32m--> 105[0m     v [38;5;241m=[39m [43m_apply_to_collection_slow[49m[43m([49m
[1;32m    106[0m [43m        [49m[43mv[49m[43m,[49m
[1;32m    107[0m [43m        [49m[43mdtype[49m[43m,[49m
[1;32m    108[0m [43m        [49m[43mfunction[49m[43m,[49m
[1;32m    109[0m [43m        [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m
[1;32m    110[0m [43m        [49m[43mwrong_dtype[49m[38;5;241;43m=[39;49m[43mwrong_dtype[49m[43m,[49m
[1;32m    111[0m [43m        [49m[43minclude_none[49m[38;5;241;43m=[39;49m[43minclude_none[49m[43m,[49m
[1;32m    112[0m [43m        [49m[43mallow_frozen[49m[38;5;241;43m=[39;49m[43mallow_frozen[49m[43m,[49m
[1;32m    113[0m [43m        [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
[1;32m    114[0m [43m    [49m[43m)[49m
[1;32m    115[0m     [38;5;28;01mif[39;00m include_none [38;5;129;01mor[39;00m v [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning_utilities/core/apply_func.py:105[0m, in [0;36m_apply_to_collection_slow[0;34m(data, dtype, function, wrong_dtype, include_none, allow_frozen, *args, **kwargs)[0m
[1;32m    104[0m [38;5;28;01mfor[39;00m k, v [38;5;129;01min[39;00m data[38;5;241m.[39mitems():
[0;32m--> 105[0m     v [38;5;241m=[39m [43m_apply_to_collection_slow[49m[43m([49m
[1;32m    106[0m [43m        [49m[43mv[49m[43m,[49m
[1;32m    107[0m [43m        [49m[43mdtype[49m[43m,[49m
[1;32m    108[0m [43m        [49m[43mfunction[49m[43m,[49m
[1;32m    109[0m [43m        [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m
[1;32m    110[0m [43m        [49m[43mwrong_dtype[49m[38;5;241;43m=[39;49m[43mwrong_dtype[49m[43m,[49m
[1;32m    111[0m [43m        [49m[43minclude_none[49m[38;5;241;43m=[39;49m[43minclude_none[49m[43m,[49m
[1;32m    112[0m [43m        [49m[43mallow_frozen[49m[38;5;241;43m=[39;49m[43mallow_frozen[49m[43m,[49m
[1;32m    113[0m [43m        [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
[1;32m    114[0m [43m    [49m[43m)[49m
[1;32m    115[0m     [38;5;28;01mif[39;00m include_none [38;5;129;01mor[39;00m v [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning_utilities/core/apply_func.py:97[0m, in [0;36m_apply_to_collection_slow[0;34m(data, dtype, function, wrong_dtype, include_none, allow_frozen, *args, **kwargs)[0m
[1;32m     96[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(data, dtype) [38;5;129;01mand[39;00m (wrong_dtype [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mor[39;00m [38;5;129;01mnot[39;00m [38;5;28misinstance[39m(data, wrong_dtype)):
[0;32m---> 97[0m     [38;5;28;01mreturn[39;00m [43mfunction[49m[43m([49m[43mdata[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     99[0m elem_type [38;5;241m=[39m [38;5;28mtype[39m(data)

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/fabric/utilities/apply_func.py:110[0m, in [0;36mmove_data_to_device[0;34m(batch, device)[0m
[1;32m    108[0m     [38;5;28;01mreturn[39;00m data
[0;32m--> 110[0m [38;5;28;01mreturn[39;00m [43mapply_to_collection[49m[43m([49m[43mbatch[49m[43m,[49m[43m [49m[43mdtype[49m[38;5;241;43m=[39;49m[43m_TransferableDataType[49m[43m,[49m[43m [49m[43mfunction[49m[38;5;241;43m=[39;49m[43mbatch_to[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning_utilities/core/apply_func.py:65[0m, in [0;36mapply_to_collection[0;34m(data, dtype, function, wrong_dtype, include_none, allow_frozen, *args, **kwargs)[0m
[1;32m     64[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(data, dtype):  [38;5;66;03m# single element[39;00m
[0;32m---> 65[0m     [38;5;28;01mreturn[39;00m [43mfunction[49m[43m([49m[43mdata[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     66[0m [38;5;28;01mif[39;00m data[38;5;241m.[39m[38;5;18m__class__[39m [38;5;129;01mis[39;00m [38;5;28mlist[39m [38;5;129;01mand[39;00m [38;5;28mall[39m([38;5;28misinstance[39m(x, dtype) [38;5;28;01mfor[39;00m x [38;5;129;01min[39;00m data):  [38;5;66;03m# 1d homogeneous list[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/fabric/utilities/apply_func.py:104[0m, in [0;36mmove_data_to_device.<locals>.batch_to[0;34m(data)[0m
[1;32m    103[0m     kwargs[[38;5;124m"[39m[38;5;124mnon_blocking[39m[38;5;124m"[39m] [38;5;241m=[39m [38;5;28;01mTrue[39;00m
[0;32m--> 104[0m data_output [38;5;241m=[39m [43mdata[49m[38;5;241;43m.[39;49m[43mto[49m[43m([49m[43mdevice[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    105[0m [38;5;28;01mif[39;00m data_output [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:

[0;31mRuntimeError[0m: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


During handling of the above exception, another exception occurred:

[0;31mRuntimeError[0m                              Traceback (most recent call last)
Cell [0;32mIn[5], line 91[0m
[1;32m     85[0m model [38;5;241m=[39m LitCNN(CNN)
[1;32m     90[0m [38;5;28mprint[39m([38;5;124m'[39m[38;5;124mModel init[39m[38;5;124m'[39m)
[0;32m---> 91[0m [43mtrainer[49m[38;5;241;43m.[39;49m[43mfit[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[43mtrain_loader[49m[43m,[49m[43m [49m[43mvalid_loader[49m[43m)[49m
[1;32m     94[0m model[38;5;241m.[39meval()
[1;32m     95[0m [38;5;28;01mwith[39;00m torch[38;5;241m.[39mno_grad():

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:539[0m, in [0;36mTrainer.fit[0;34m(self, model, train_dataloaders, val_dataloaders, datamodule, ckpt_path)[0m
[1;32m    537[0m [38;5;28mself[39m[38;5;241m.[39mstate[38;5;241m.[39mstatus [38;5;241m=[39m TrainerStatus[38;5;241m.[39mRUNNING
[1;32m    538[0m [38;5;28mself[39m[38;5;241m.[39mtraining [38;5;241m=[39m [38;5;28;01mTrue[39;00m
[0;32m--> 539[0m [43mcall[49m[38;5;241;43m.[39;49m[43m_call_and_handle_interrupt[49m[43m([49m
[1;32m    540[0m [43m    [49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_fit_impl[49m[43m,[49m[43m [49m[43mmodel[49m[43m,[49m[43m [49m[43mtrain_dataloaders[49m[43m,[49m[43m [49m[43mval_dataloaders[49m[43m,[49m[43m [49m[43mdatamodule[49m[43m,[49m[43m [49m[43mckpt_path[49m
[1;32m    541[0m [43m[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/call.py:68[0m, in [0;36m_call_and_handle_interrupt[0;34m(trainer, trainer_fn, *args, **kwargs)[0m
[1;32m     66[0m [38;5;28;01mexcept[39;00m [38;5;167;01mBaseException[39;00m [38;5;28;01mas[39;00m exception:
[1;32m     67[0m     _interrupt(trainer, exception)
[0;32m---> 68[0m     [43mtrainer[49m[38;5;241;43m.[39;49m[43m_teardown[49m[43m([49m[43m)[49m
[1;32m     69[0m     [38;5;66;03m# teardown might access the stage so we reset it after[39;00m
[1;32m     70[0m     trainer[38;5;241m.[39mstate[38;5;241m.[39mstage [38;5;241m=[39m [38;5;28;01mNone[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/trainer/trainer.py:1005[0m, in [0;36mTrainer._teardown[0;34m(self)[0m
[1;32m   1002[0m [38;5;28;01mdef[39;00m [38;5;21m_teardown[39m([38;5;28mself[39m) [38;5;241m-[39m[38;5;241m>[39m [38;5;28;01mNone[39;00m:
[1;32m   1003[0m [38;5;250m    [39m[38;5;124;03m"""This is the Trainer's internal teardown, unrelated to the `teardown` hooks in LightningModule and Callback;[39;00m
[1;32m   1004[0m [38;5;124;03m    those are handled by :meth:`_call_teardown_hook`."""[39;00m
[0;32m-> 1005[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mstrategy[49m[38;5;241;43m.[39;49m[43mteardown[49m[43m([49m[43m)[49m
[1;32m   1006[0m     loop [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_active_loop
[1;32m   1007[0m     [38;5;66;03m# loop should never be `None` here but it can because we don't know the trainer stage with `ddp_spawn`[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/pytorch/strategies/strategy.py:536[0m, in [0;36mStrategy.teardown[0;34m(self)[0m
[1;32m    534[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mlightning_module [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m    535[0m     log[38;5;241m.[39mdebug([38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m[38;5;132;01m}[39;00m[38;5;124m: moving model to CPU[39m[38;5;124m"[39m)
[0;32m--> 536[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mlightning_module[49m[38;5;241;43m.[39;49m[43mcpu[49m[43m([49m[43m)[49m
[1;32m    537[0m [38;5;28mself[39m[38;5;241m.[39mprecision_plugin[38;5;241m.[39mteardown()
[1;32m    538[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39maccelerator [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/lightning/fabric/utilities/device_dtype_mixin.py:82[0m, in [0;36m_DeviceDtypeModuleMixin.cpu[0;34m(self)[0m
[1;32m     80[0m [38;5;250m[39m[38;5;124;03m"""See :meth:`torch.nn.Module.cpu`."""[39;00m
[1;32m     81[0m _update_properties([38;5;28mself[39m, device[38;5;241m=[39mtorch[38;5;241m.[39mdevice([38;5;124m"[39m[38;5;124mcpu[39m[38;5;124m"[39m))
[0;32m---> 82[0m [38;5;28;01mreturn[39;00m [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[43mcpu[49m[43m([49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1118[0m, in [0;36mModule.cpu[0;34m(self)[0m
[1;32m   1109[0m [38;5;28;01mdef[39;00m [38;5;21mcpu[39m([38;5;28mself[39m: T) [38;5;241m-[39m[38;5;241m>[39m T:
[1;32m   1110[0m [38;5;250m    [39m[38;5;124mr[39m[38;5;124;03m"""Move all model parameters and buffers to the CPU.[39;00m
[1;32m   1111[0m
[1;32m   1112[0m [38;5;124;03m    .. note::[39;00m
[0;32m   (...)[0m
[1;32m   1116[0m [38;5;124;03m        Module: self[39;00m
[1;32m   1117[0m [38;5;124;03m    """[39;00m
[0;32m-> 1118[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_apply[49m[43m([49m[38;5;28;43;01mlambda[39;49;00m[43m [49m[43mt[49m[43m:[49m[43m [49m[43mt[49m[38;5;241;43m.[39;49m[43mcpu[49m[43m([49m[43m)[49m[43m)[49m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:900[0m, in [0;36mModule._apply[0;34m(self, fn, recurse)[0m
[1;32m    898[0m [38;5;28;01mif[39;00m recurse:
[1;32m    899[0m     [38;5;28;01mfor[39;00m module [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39mchildren():
[0;32m--> 900[0m         [43mmodule[49m[38;5;241;43m.[39;49m[43m_apply[49m[43m([49m[43mfn[49m[43m)[49m
[1;32m    902[0m [38;5;28;01mdef[39;00m [38;5;21mcompute_should_use_set_data[39m(tensor, tensor_applied):
[1;32m    903[0m     [38;5;28;01mif[39;00m torch[38;5;241m.[39m_has_compatible_shallow_copy_type(tensor, tensor_applied):
[1;32m    904[0m         [38;5;66;03m# If the new tensor has compatible tensor type as the existing tensor,[39;00m
[1;32m    905[0m         [38;5;66;03m# the current behavior is to change the tensor in-place using `.data =`,[39;00m
[0;32m   (...)[0m
[1;32m    910[0m         [38;5;66;03m# global flag to let the user control whether they want the future[39;00m
[1;32m    911[0m         [38;5;66;03m# behavior of overwriting the existing tensor or not.[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:900[0m, in [0;36mModule._apply[0;34m(self, fn, recurse)[0m
[1;32m    898[0m [38;5;28;01mif[39;00m recurse:
[1;32m    899[0m     [38;5;28;01mfor[39;00m module [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39mchildren():
[0;32m--> 900[0m         [43mmodule[49m[38;5;241;43m.[39;49m[43m_apply[49m[43m([49m[43mfn[49m[43m)[49m
[1;32m    902[0m [38;5;28;01mdef[39;00m [38;5;21mcompute_should_use_set_data[39m(tensor, tensor_applied):
[1;32m    903[0m     [38;5;28;01mif[39;00m torch[38;5;241m.[39m_has_compatible_shallow_copy_type(tensor, tensor_applied):
[1;32m    904[0m         [38;5;66;03m# If the new tensor has compatible tensor type as the existing tensor,[39;00m
[1;32m    905[0m         [38;5;66;03m# the current behavior is to change the tensor in-place using `.data =`,[39;00m
[0;32m   (...)[0m
[1;32m    910[0m         [38;5;66;03m# global flag to let the user control whether they want the future[39;00m
[1;32m    911[0m         [38;5;66;03m# behavior of overwriting the existing tensor or not.[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:927[0m, in [0;36mModule._apply[0;34m(self, fn, recurse)[0m
[1;32m    923[0m [38;5;66;03m# Tensors stored in modules are graph leaves, and we don't want to[39;00m
[1;32m    924[0m [38;5;66;03m# track autograd history of `param_applied`, so we have to use[39;00m
[1;32m    925[0m [38;5;66;03m# `with torch.no_grad():`[39;00m
[1;32m    926[0m [38;5;28;01mwith[39;00m torch[38;5;241m.[39mno_grad():
[0;32m--> 927[0m     param_applied [38;5;241m=[39m [43mfn[49m[43m([49m[43mparam[49m[43m)[49m
[1;32m    928[0m p_should_use_set_data [38;5;241m=[39m compute_should_use_set_data(param, param_applied)
[1;32m    930[0m [38;5;66;03m# subclasses may have multiple child tensors so we need to use swap_tensors[39;00m

File [0;32m/felles_gfi/felles_gfi_users/rogui7909/miniforge3/envs/robin/lib/python3.12/site-packages/torch/nn/modules/module.py:1118[0m, in [0;36mModule.cpu.<locals>.<lambda>[0;34m(t)[0m
[1;32m   1109[0m [38;5;28;01mdef[39;00m [38;5;21mcpu[39m([38;5;28mself[39m: T) [38;5;241m-[39m[38;5;241m>[39m T:
[1;32m   1110[0m [38;5;250m    [39m[38;5;124mr[39m[38;5;124;03m"""Move all model parameters and buffers to the CPU.[39;00m
[1;32m   1111[0m
[1;32m   1112[0m [38;5;124;03m    .. note::[39;00m
[0;32m   (...)[0m
[1;32m   1116[0m [38;5;124;03m        Module: self[39;00m
[1;32m   1117[0m [38;5;124;03m    """[39;00m
[0;32m-> 1118[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_apply([38;5;28;01mlambda[39;00m t: [43mt[49m[38;5;241;43m.[39;49m[43mcpu[49m[43m([49m[43m)[49m)

[0;31mRuntimeError[0m: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


[23;0t
